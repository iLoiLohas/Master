<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>EALib: ChromosomeCMA.h Source File</title>
<script type="text/javaScript" src="search/search.js"></script>
<link href="../css/main.css" rel="stylesheet" type="text/css"/>
</head>
<body id="type-b">

<div id="wrap">
<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
<div id="poweredby">
<img style="width: 95%;" src="../images/SharkLogo.png"/>
</div>		
  
<ul id="nav">
  <li class="first"><a href="../index.html">About Shark</a></li>
  <li><a href="#">Sourceforge</a>
  
  <ul>
    <li class="first"><a href="http://shark-project.sourceforge.net">Project Summary</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/files/">Downloads</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/develop">Subversion Repository</a></li>
  </ul>
  
</li>
<li class="first"><a href="../GettingStarted.html">Getting Started</a>
<li class="first"><a href="../Tutorials.html">Tutorials</a>
<li class="first"><a href="../FAQ.html">FAQ</a>

<li class="first"><a href="#">Main Modules</a>
<ul>
  <li class="first"><a href="../ReClaM/index.html">ReClaM</a>
  <li class="first"><a href="../EALib/index.html">EALib</a>
  <li class="first"><a href="../MOO-EALib/index.html">MOO-EALib</a>
  <li class="first"><a href="../Fuzzy/index.html">Fuzzy</a>
</ul>
</li>
<li class="first"><a href="#">Tools</a>
<ul>
  <li class="first"><a href="../Mixture/index.html">Mixture</a>
  <li><a href="../Array/index.html">Array</a>
  <li><a href="../Rng/index.html">Rng</a>
  <li><a href="../LinAlg/index.html">LinAlg</a>
  <li class="last"><a href="../FileUtil/index.html">FileUtil</a>		    
</ul>
</li>
</ul>
</div>

<!--<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
  <ul id="nav">
    <li><a href="../index.html"><span>Shark&nbsp;Main&nbsp;Page</span></a></li>
    <li><a href="../Array/index.html"><span>Array</span></a></li>
    <li><a href="../Rng/index.html"><span>Rng</span></a></li>
    <li><a href="../LinAlg/index.html"><span>LinAlg</span></a></li>
    <li><a href="../FileUtil/index.html"><span>FileUtil</span></a></li>
    <li><a href="../EALib/index.html"><span>EALib</span></a></li>
    <li><a href="../MOO-EALib/index.html"><span>MOO-EALib</span></a></li>
    <li class="active"><a href="../ReClaM/index.html"><span>ReClaM</span></a></li>
    <li><a href="../Fuzzy/index.html"><span>Fuzzy</span></a></li>
    <li><a href="../Mixture/index.html"><span>Mixture</span></a></li>
    <li><a href="../tutorials/index.html"><span>Tutorials</span></a></li>
    <li><a href="../faq/index.html"><span>FAQ</span></a></li>
  </ul>
 </div> -->
<!-- Generated by Doxygen 1.7.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>ChromosomeCMA.h</h1>  </div>
</div>
<div class="contents">
<a href="_chromosome_c_m_a_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//===========================================================================</span>
<a name="l00050"></a>00050 <span class="comment"></span><span class="comment">//===========================================================================</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="preprocessor">#ifndef __CHROMOSOME_CMA_H</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span><span class="preprocessor">#define __CHROMOSOME_CMA_H</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &lt;SharkDefs.h&gt;</span>
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="preprocessor">#include &lt;EALib/ChromosomeT.h&gt;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &lt;EALib/Population.h&gt;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &lt;Array/ArrayOp.h&gt;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &lt;Array/ArrayIo.h&gt;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &lt;LinAlg/LinAlg.h&gt;</span>
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 
<a name="l00067"></a><a class="code" href="class_chromosome_c_m_a.html">00067</a> <span class="keyword">class </span><a class="code" href="class_chromosome_c_m_a.html" title="Elitist CMA evolution strategy.">ChromosomeCMA</a> : <span class="keyword">public</span> <a class="code" href="class_chromosome_t.html" title="template class for chromosomes">ChromosomeT</a>&lt; double &gt;
<a name="l00068"></a>00068 {
<a name="l00069"></a>00069 <span class="keyword">public</span>:
<a name="l00070"></a><a class="code" href="class_chromosome_c_m_a.html#a9fd55364f569226002368c17e829fccf">00070</a>     <a class="code" href="class_chromosome_c_m_a.html#a9fd55364f569226002368c17e829fccf">ChromosomeCMA</a>()
<a name="l00071"></a>00071     {};
<a name="l00072"></a><a class="code" href="class_chromosome_c_m_a.html#a95df812c3337064c11b517c519e7b293">00072</a>     <span class="keyword">explicit</span> <a class="code" href="class_chromosome_c_m_a.html#a9fd55364f569226002368c17e829fccf">ChromosomeCMA</a>(<span class="keywordtype">unsigned</span> l) : <a class="code" href="class_chromosome_t.html" title="template class for chromosomes">ChromosomeT</a>&lt; double &gt;(l)
<a name="l00073"></a>00073     {};
<a name="l00074"></a><a class="code" href="class_chromosome_c_m_a.html#a7e5d5a005e4d0e53819aeb875a0fddbc">00074</a>     <a class="code" href="class_chromosome_c_m_a.html#a9fd55364f569226002368c17e829fccf">ChromosomeCMA</a>(<span class="keywordtype">unsigned</span> l, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; v): <a class="code" href="class_chromosome_t.html" title="template class for chromosomes">ChromosomeT</a>&lt; double &gt;(l, v)
<a name="l00075"></a>00075     {};
<a name="l00076"></a><a class="code" href="class_chromosome_c_m_a.html#ae151a2afca1f3a057a4a7e5900a94855">00076</a>     <a class="code" href="class_chromosome_c_m_a.html#a9fd55364f569226002368c17e829fccf">ChromosomeCMA</a>(<span class="keyword">const</span> std::vector&lt; double &gt;&amp; v) : <a class="code" href="class_chromosome_t.html" title="template class for chromosomes">ChromosomeT</a>&lt; double &gt;(v)
<a name="l00077"></a>00077     {};
<a name="l00078"></a><a class="code" href="class_chromosome_c_m_a.html#a57bfe0dfab49974f0f848e3b1d6b2533">00078</a>     <a class="code" href="class_chromosome_c_m_a.html#a57bfe0dfab49974f0f848e3b1d6b2533">~ChromosomeCMA</a>()
<a name="l00079"></a>00079     {};
<a name="l00080"></a>00080 
<a name="l00081"></a><a class="code" href="class_chromosome_c_m_a.html#ad491b3d662f1fe3c10a304295ce74019">00081</a>     <span class="keywordtype">void</span> <a class="code" href="class_chromosome.html#a8043a30b7ea0db65fc29c673d5e3edbc">init</a>(<span class="keywordtype">unsigned</span>             dimension,
<a name="l00082"></a>00082               std::vector&lt;double &gt; stdv,
<a name="l00083"></a>00083               <span class="keywordtype">double</span>               initialSigma,
<a name="l00084"></a>00084               <a class="code" href="class_chromosome_t_3_01double_01_4.html" title="chromosome based on double numbers">ChromosomeT&lt;double&gt;</a> &amp;MinInit,
<a name="l00085"></a>00085               <a class="code" href="class_chromosome_t_3_01double_01_4.html" title="chromosome based on double numbers">ChromosomeT&lt;double&gt;</a> &amp;MaxInit,
<a name="l00086"></a>00086               <span class="keywordtype">int</span>                  noOffspring = 1,
<a name="l00087"></a>00087               <span class="keywordtype">double</span>               lower       = 0.)
<a name="l00088"></a>00088     {
<a name="l00089"></a>00089         <span class="keywordtype">unsigned</span> i;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091         n     = dimension;
<a name="l00092"></a>00092         sigma = initialSigma;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094         (*this).resize(n);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096         pc.resize(n);
<a name="l00097"></a>00097         C.resize(n, n, <span class="keyword">false</span>);
<a name="l00098"></a>00098         B.resize(n, n, <span class="keyword">false</span>);
<a name="l00099"></a>00099         eigenvalues.resize(n);
<a name="l00100"></a>00100         z.resize(n);
<a name="l00101"></a>00101         lastStep.resize(n);
<a name="l00102"></a>00102 
<a name="l00103"></a>00103         <a class="code" href="class_chromosome_t__num.html#a91f2be72a02186aec46d21862dc967fe">initialize</a>(MinInit, MaxInit);
<a name="l00104"></a>00104 
<a name="l00105"></a>00105         lambda = noOffspring;
<a name="l00106"></a>00106         cc      = 2. / (2. + n);
<a name="l00107"></a>00107         ccov    = 2. / (n * n + 6.);
<a name="l00108"></a>00108 
<a name="l00109"></a>00109         lambdaSucc = 0.;
<a name="l00110"></a>00110         noOffspringSinceUpdate = 0;
<a name="l00111"></a>00111 
<a name="l00112"></a>00112         lowerBound = lower;
<a name="l00113"></a>00113 
<a name="l00114"></a>00114         <span class="comment">// succprob, p_succ</span>
<a name="l00115"></a>00115         psPrime = 1. / (5. + sqrt((<span class="keywordtype">double</span>)lambda) / 2.);
<a name="l00116"></a>00116         <span class="comment">//psPrime = 1. / 2. * 1./(5. + (double)lambda/4.);</span>
<a name="l00117"></a>00117         ps      = psPrime;
<a name="l00118"></a>00118 
<a name="l00119"></a>00119         cp = (psPrime * lambda) / (2 +  psPrime * lambda);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121         d = 1 + n / (lambda * 2);
<a name="l00122"></a>00122 
<a name="l00123"></a>00123         <span class="comment">// init paths</span>
<a name="l00124"></a>00124         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {
<a name="l00125"></a>00125             pc(i) = 0.;
<a name="l00126"></a>00126             <span class="keywordflow">for</span> (j = 0; j &lt; n; j++) {
<a name="l00127"></a>00127                 <span class="keywordflow">if</span> (i != j) C(i, j) = 0;
<a name="l00128"></a>00128                 <span class="keywordflow">else</span> C(i, j) = Shark::sqr(stdv[i]);
<a name="l00129"></a>00129             }
<a name="l00130"></a>00130         }
<a name="l00131"></a>00131         <span class="comment">// eigenvalues and eigenvector matrix B</span>
<a name="l00132"></a>00132         eigensymm(C, B, eigenvalues);
<a name="l00133"></a>00133         needCovarianceUpdate = <span class="keyword">false</span>;
<a name="l00134"></a>00134     }
<a name="l00135"></a>00135 
<a name="l00136"></a><a class="code" href="class_chromosome_c_m_a.html#a61cc908956cacea0d07085fda580ea71">00136</a>     <span class="keywordtype">void</span> <a class="code" href="class_chromosome.html#a8043a30b7ea0db65fc29c673d5e3edbc">init</a>(<span class="keywordtype">unsigned</span> dimension,
<a name="l00137"></a>00137               <span class="keywordtype">double</span>   initialSigma,
<a name="l00138"></a>00138               <span class="keywordtype">double</span>   MinInit,
<a name="l00139"></a>00139               <span class="keywordtype">double</span>   MaxInit,
<a name="l00140"></a>00140               <span class="keywordtype">int</span>      lambda = 1)
<a name="l00141"></a>00141     {
<a name="l00142"></a>00142         std::vector&lt;double&gt; stdv(dimension);
<a name="l00143"></a>00143         <a class="code" href="class_chromosome_t_3_01double_01_4.html" title="chromosome based on double numbers">ChromosomeT&lt;double&gt;</a> chromeMinInit(dimension), chromeMaxInit(dimension);
<a name="l00144"></a>00144 
<a name="l00145"></a>00145         <span class="keywordflow">for</span> (i = 0; i &lt; dimension; i++) {
<a name="l00146"></a>00146             stdv         [i] = 1;
<a name="l00147"></a>00147             chromeMinInit[i] = MinInit;
<a name="l00148"></a>00148             chromeMaxInit[i] = MaxInit;
<a name="l00149"></a>00149         }
<a name="l00150"></a>00150         <a class="code" href="class_chromosome.html#a8043a30b7ea0db65fc29c673d5e3edbc">init</a>(dimension, stdv, initialSigma, chromeMinInit, chromeMaxInit, lambda);
<a name="l00151"></a>00151     }
<a name="l00152"></a>00152 
<a name="l00153"></a><a class="code" href="class_chromosome_c_m_a.html#a9dc182910ec7f5aae352548c8988adda">00153</a>     <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#a9dc182910ec7f5aae352548c8988adda">mutate</a>()
<a name="l00154"></a>00154     {
<a name="l00155"></a>00155         <span class="comment">// draw random vector</span>
<a name="l00156"></a>00156         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) z(i) = Rng::gauss(0, 1);
<a name="l00157"></a>00157         lastStep = 0;
<a name="l00158"></a>00158 
<a name="l00159"></a>00159         <span class="comment">// mutate objective variables, Eq. (1)</span>
<a name="l00160"></a>00160         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l00161"></a>00161             <span class="keywordflow">for</span> (j = 0; j &lt; n; j++)
<a name="l00162"></a>00162                 lastStep(i) += B(i, j) * sqrt(fabs(eigenvalues(j))) * z(j);
<a name="l00163"></a>00163 
<a name="l00164"></a>00164         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l00165"></a>00165             (*<span class="keyword">this</span>)[i] += sigma * lastStep(i);
<a name="l00166"></a>00166 
<a name="l00167"></a>00167         needCovarianceUpdate = <span class="keyword">true</span>;
<a name="l00168"></a>00168     };
<a name="l00169"></a>00169 
<a name="l00170"></a><a class="code" href="class_chromosome_c_m_a.html#aa596d8a5a52f7918b3ec08ebdcc37b9e">00170</a>     <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#aa596d8a5a52f7918b3ec08ebdcc37b9e">updateGlobalStepsize</a>()
<a name="l00171"></a>00171     {
<a name="l00172"></a>00172         <a class="code" href="class_chromosome_c_m_a.html#aa596d8a5a52f7918b3ec08ebdcc37b9e">updateGlobalStepsize</a>(lambdaSucc / noOffspringSinceUpdate);
<a name="l00173"></a>00173         lambdaSucc = 0.;
<a name="l00174"></a>00174         noOffspringSinceUpdate = 0;
<a name="l00175"></a>00175     }
<a name="l00176"></a>00176 
<a name="l00177"></a><a class="code" href="class_chromosome_c_m_a.html#aad313284fa6f3f52d0e3f5eb15079496">00177</a>     <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#aad313284fa6f3f52d0e3f5eb15079496">updateLambdaSucc</a>(<span class="keywordtype">bool</span> better)
<a name="l00178"></a>00178     {
<a name="l00179"></a>00179         noOffspringSinceUpdate++;
<a name="l00180"></a>00180         <span class="keywordflow">if</span> (better) lambdaSucc++;
<a name="l00181"></a>00181     }
<a name="l00182"></a>00182 
<a name="l00183"></a><a class="code" href="class_chromosome_c_m_a.html#a163d8d16152d910e235f308fe96928d2">00183</a>     <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#aa596d8a5a52f7918b3ec08ebdcc37b9e">updateGlobalStepsize</a>(<span class="keywordtype">double</span> nsucc)
<a name="l00184"></a>00184     {
<a name="l00185"></a>00185         <span class="comment">// Step size update by accumulated success probability</span>
<a name="l00186"></a>00186         ps    = (1 - cp) * ps + cp * (nsucc / lambda);
<a name="l00187"></a>00187         sigma *= exp((ps - (psPrime / (1 - psPrime)) * (1 - ps)) / d);
<a name="l00188"></a>00188 
<a name="l00189"></a>00189         <span class="keywordflow">if</span> ((sigma * sqrt(fabs(eigenvalues(n - 1)))) &lt; lowerBound)
<a name="l00190"></a>00190             sigma = lowerBound / sqrt(fabs(eigenvalues(n - 1)));
<a name="l00191"></a>00191     };
<a name="l00192"></a>00192 
<a name="l00193"></a><a class="code" href="class_chromosome_c_m_a.html#ae3b0b97139d93901c98e5a4daa18ead3">00193</a>     <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#a7436ca0927ceeb2fe64a973325a50554">updateCovariance</a>(<a class="code" href="class_individual.html" title="Base class for individuals in a population.">Individual</a>&amp; parent)
<a name="l00194"></a>00194     {
<a name="l00195"></a>00195         <span class="comment">// Eq. (2) &amp; Eq. (4)</span>
<a name="l00196"></a>00196         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {
<a name="l00197"></a>00197             <span class="keywordflow">if</span> (ps &lt; 0.44) pc(i) = (1 - cc) * pc(i)
<a name="l00198"></a>00198                                        + sqrt(cc * (2 - cc))
<a name="l00199"></a>00199                                        * ((*this)[i] - (<span class="keyword">dynamic_cast&lt;</span>std::vector&lt;double &gt; &amp; <span class="keyword">&gt;</span>(parent[0]))[i]) / sigma;
<a name="l00200"></a>00200             <span class="keywordflow">else</span> pc(i) = (1 - cc) * pc(i);
<a name="l00201"></a>00201         }
<a name="l00202"></a>00202 
<a name="l00203"></a>00203         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {
<a name="l00204"></a>00204             <span class="keywordflow">for</span> (j = 0; j &lt; n; j++) {
<a name="l00205"></a>00205                 <span class="keywordflow">if</span> (ps &gt;= 0.44) C(i, j) = (1 - ccov) * C(i, j)
<a name="l00206"></a>00206                                               + ccov * (pc(i) * pc(j) + cc * (2 - cc) * C(i, j));
<a name="l00207"></a>00207                 <span class="keywordflow">else</span> C(i, j) = (1 - ccov) * C(i, j)
<a name="l00208"></a>00208                                    + ccov * pc(i) * pc(j);
<a name="l00209"></a>00209             }
<a name="l00210"></a>00210         }
<a name="l00211"></a>00211 
<a name="l00212"></a>00212         <span class="comment">// eigenvalues eigenvalues and eigenvector matrix B</span>
<a name="l00213"></a>00213         eigensymm(C, B, eigenvalues);
<a name="l00214"></a>00214 
<a name="l00215"></a>00215         needCovarianceUpdate = <span class="keyword">false</span>;
<a name="l00216"></a>00216     };
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="class_chromosome_c_m_a.html#a7436ca0927ceeb2fe64a973325a50554">00218</a>     <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#a7436ca0927ceeb2fe64a973325a50554">updateCovariance</a>()
<a name="l00219"></a>00219     {
<a name="l00220"></a>00220         <span class="comment">// Eq. (2) &amp; Eq. (4)</span>
<a name="l00221"></a>00221         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {
<a name="l00222"></a>00222             <span class="keywordflow">if</span> (ps &lt; 0.44) pc(i) = (1 - cc) * pc(i) + sqrt(cc * (2 - cc)) * lastStep(i);
<a name="l00223"></a>00223             <span class="keywordflow">else</span> pc(i) = (1 - cc) * pc(i);
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {
<a name="l00227"></a>00227             <span class="keywordflow">for</span> (j = 0; j &lt; n; j++) {
<a name="l00228"></a>00228                 <span class="keywordflow">if</span> (ps &gt;= 0.44) C(i, j) = (1 - ccov) * C(i, j)
<a name="l00229"></a>00229                                               + ccov * (pc(i) * pc(j) + cc * (2 - cc) * C(i, j));
<a name="l00230"></a>00230                 <span class="keywordflow">else</span> C(i, j) = (1 - ccov) * C(i, j)
<a name="l00231"></a>00231                                    + ccov * pc(i) * pc(j);
<a name="l00232"></a>00232             }
<a name="l00233"></a>00233         }
<a name="l00234"></a>00234 
<a name="l00235"></a>00235         <span class="comment">// eigenvalues eigenvalues and eigenvector matrix B</span>
<a name="l00236"></a>00236         eigensymm(C, B, eigenvalues);
<a name="l00237"></a>00237 
<a name="l00238"></a>00238         needCovarianceUpdate = <span class="keyword">false</span>;
<a name="l00239"></a>00239     };
<a name="l00240"></a>00240 
<a name="l00241"></a><a class="code" href="class_chromosome_c_m_a.html#af098f6d86ee15cff037d2287d0df81b0">00241</a>     <span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="class_chromosome_c_m_a.html#af098f6d86ee15cff037d2287d0df81b0">getC</a>()<span class="keyword"> const</span>
<a name="l00242"></a>00242 <span class="keyword">    </span>{
<a name="l00243"></a>00243         <span class="keywordflow">return</span> C;
<a name="l00244"></a>00244     }
<a name="l00245"></a>00245 
<a name="l00246"></a><a class="code" href="class_chromosome_c_m_a.html#a75330c8df3e8f23b29adfe61087563d4">00246</a>     <span class="keywordtype">double</span> <a class="code" href="class_chromosome_c_m_a.html#a75330c8df3e8f23b29adfe61087563d4">getSigma</a>()<span class="keyword"> const</span>
<a name="l00247"></a>00247 <span class="keyword">    </span>{
<a name="l00248"></a>00248         <span class="keywordflow">return</span> sigma;
<a name="l00249"></a>00249     };
<a name="l00250"></a>00250 
<a name="l00251"></a><a class="code" href="class_chromosome_c_m_a.html#a2a1397dad7247051abc1c17e18d25bba">00251</a>     <span class="keywordtype">double</span> <a class="code" href="class_chromosome_c_m_a.html#a2a1397dad7247051abc1c17e18d25bba">getCondition</a>()<span class="keyword"> const</span>
<a name="l00252"></a>00252 <span class="keyword">    </span>{
<a name="l00253"></a>00253         <span class="keywordflow">return</span> eigenvalues(0) / eigenvalues(n - 1);
<a name="l00254"></a>00254     }
<a name="l00255"></a>00255 
<a name="l00256"></a><a class="code" href="class_chromosome_c_m_a.html#aeea2a4a17a9682504372441403653801">00256</a>     <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#aeea2a4a17a9682504372441403653801">setLower</a>(<span class="keywordtype">double</span> lower)
<a name="l00257"></a>00257     {
<a name="l00258"></a>00258         lowerBound = lower;
<a name="l00259"></a>00259     }
<a name="l00260"></a>00260 
<a name="l00261"></a><a class="code" href="class_chromosome_c_m_a.html#a0ed4977152d799f705e899e7c11cec43">00261</a>     <span class="keywordtype">bool</span> <a class="code" href="class_chromosome_c_m_a.html#a0ed4977152d799f705e899e7c11cec43">covarianceUpdateNeeded</a>()
<a name="l00262"></a>00262     {
<a name="l00263"></a>00263         <span class="keywordflow">return</span> needCovarianceUpdate;
<a name="l00264"></a>00264     }
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 <span class="keyword">protected</span>:
<a name="l00267"></a><a class="code" href="class_chromosome_c_m_a.html#a885b17019f0bd16849e7e1ed860b59e8">00267</a>     <a class="code" href="class_chromosome.html" title="base class for chromosomes">Chromosome</a>* <a class="code" href="class_chromosome_c_m_a.html#a885b17019f0bd16849e7e1ed860b59e8">clone</a>()<span class="keyword"> const</span>
<a name="l00268"></a>00268 <span class="keyword">    </span>{
<a name="l00269"></a>00269         <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_chromosome_c_m_a.html#a9fd55364f569226002368c17e829fccf">ChromosomeCMA</a>(*<span class="keyword">this</span>);
<a name="l00270"></a>00270     }
<a name="l00271"></a><a class="code" href="class_chromosome_c_m_a.html#a8e16cce0d08f19e5515c8d0382213e86">00271</a>     <a class="code" href="class_chromosome.html" title="base class for chromosomes">Chromosome</a>* <a class="code" href="class_chromosome_c_m_a.html#a8e16cce0d08f19e5515c8d0382213e86">empty</a>()<span class="keyword"> const</span>
<a name="l00272"></a>00272 <span class="keyword">    </span>{
<a name="l00273"></a>00273         <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_chromosome_c_m_a.html#a9fd55364f569226002368c17e829fccf">ChromosomeCMA</a>;
<a name="l00274"></a>00274     }
<a name="l00275"></a>00275 
<a name="l00276"></a><a class="code" href="class_chromosome_c_m_a.html#a2568f3b4e7a5721b3c9a63ceb2130612">00276</a>     <span class="keywordtype">int</span> <a class="code" href="class_chromosome_c_m_a.html#a2568f3b4e7a5721b3c9a63ceb2130612">pvm_pkchrom</a>()
<a name="l00277"></a>00277     {
<a name="l00278"></a>00278         <span class="keywordtype">unsigned</span>  i;
<a name="l00279"></a>00279         <span class="keywordtype">double</span>*   u;
<a name="l00280"></a>00280         <span class="keywordtype">unsigned</span>* s;
<a name="l00281"></a>00281 
<a name="l00282"></a>00282         this-&gt;<a class="code" href="class_chromosome_c_m_a.html#a2568f3b4e7a5721b3c9a63ceb2130612">ChromosomeT&lt;double&gt;::pvm_pkchrom</a>();
<a name="l00283"></a>00283 
<a name="l00284"></a>00284         s = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[2];
<a name="l00285"></a>00285         s[0] = n;
<a name="l00286"></a>00286         s[1] = lambda;
<a name="l00287"></a>00287         <a class="code" href="_p_v_minterface_8cpp.html#a80a9f340ec569800544fbdd668546334">pvm_pkuint</a>(s, 2, 1);
<a name="l00288"></a>00288         <span class="keyword">delete</span>[] s;
<a name="l00289"></a>00289 
<a name="l00290"></a>00290         u = <span class="keyword">new</span> <span class="keywordtype">double</span>[Shark::min(7u,n*n)];
<a name="l00291"></a>00291         u[0] = sigma;
<a name="l00292"></a>00292         u[1] = psPrime;
<a name="l00293"></a>00293         u[2] = cc;
<a name="l00294"></a>00294         u[3] = ccov;
<a name="l00295"></a>00295         u[4] = d;
<a name="l00296"></a>00296         u[5] = ps;
<a name="l00297"></a>00297         u[6] = cp;
<a name="l00298"></a>00298         <a class="code" href="_p_v_minterface_8cpp.html#a0d39a4495259a59feec9c3a50a24d247">pvm_pkdouble</a>(u, 7, 1);
<a name="l00299"></a>00299 
<a name="l00300"></a>00300         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) u[i] = pc(i);
<a name="l00301"></a>00301         <a class="code" href="_p_v_minterface_8cpp.html#a0d39a4495259a59feec9c3a50a24d247">pvm_pkdouble</a>(u, n, 1);
<a name="l00302"></a>00302 
<a name="l00303"></a>00303         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) u[i] = eigenvalues(i);
<a name="l00304"></a>00304         <a class="code" href="_p_v_minterface_8cpp.html#a0d39a4495259a59feec9c3a50a24d247">pvm_pkdouble</a>(u, n, 1);
<a name="l00305"></a>00305 
<a name="l00306"></a>00306         <span class="keywordflow">for</span> (i = 0; i &lt; n*n; i++) u[i] = C.elem(i);
<a name="l00307"></a>00307         <a class="code" href="_p_v_minterface_8cpp.html#a0d39a4495259a59feec9c3a50a24d247">pvm_pkdouble</a>(u, n*n, 1);
<a name="l00308"></a>00308 
<a name="l00309"></a>00309         <span class="keywordflow">for</span> (i = 0; i &lt; n*n; i++) u[i] = B.elem(i);
<a name="l00310"></a>00310         <a class="code" href="_p_v_minterface_8cpp.html#a0d39a4495259a59feec9c3a50a24d247">pvm_pkdouble</a>(u, n*n, 1);
<a name="l00311"></a>00311 
<a name="l00312"></a>00312         <span class="keyword">delete</span>[] u;
<a name="l00313"></a>00313         <span class="keywordflow">return</span> 1;
<a name="l00314"></a>00314     };
<a name="l00315"></a>00315 
<a name="l00316"></a><a class="code" href="class_chromosome_c_m_a.html#ae4827a99d256835d16513b7f66a84da3">00316</a>     <span class="keywordtype">int</span> <a class="code" href="class_chromosome_c_m_a.html#ae4827a99d256835d16513b7f66a84da3">pvm_upkchrom</a>()
<a name="l00317"></a>00317     {
<a name="l00318"></a>00318         <span class="keywordtype">unsigned</span>  i;
<a name="l00319"></a>00319         <span class="keywordtype">double</span>*   u;
<a name="l00320"></a>00320         <span class="keywordtype">unsigned</span>* s;
<a name="l00321"></a>00321 
<a name="l00322"></a>00322         this-&gt;<a class="code" href="class_chromosome_c_m_a.html#ae4827a99d256835d16513b7f66a84da3">ChromosomeT&lt;double&gt;::pvm_upkchrom</a>();
<a name="l00323"></a>00323 
<a name="l00324"></a>00324         s = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[2];
<a name="l00325"></a>00325         <a class="code" href="_p_v_minterface_8cpp.html#a80a9f340ec569800544fbdd668546334">pvm_pkuint</a>(s, 2, 1);
<a name="l00326"></a>00326         n       = s[0];
<a name="l00327"></a>00327         lambda  = s[1];
<a name="l00328"></a>00328         <span class="keyword">delete</span>[] s;
<a name="l00329"></a>00329 
<a name="l00330"></a>00330         <span class="keywordflow">if</span> (n != this-&gt;<a class="code" href="class_chromosome_t__base.html#a2a6905f5474b221799bba93b360549ca">size</a>()) <span class="keywordflow">throw</span> SHARKEXCEPTION(<span class="stringliteral">&quot;[ChromosomeCMA::pvm_upkchrom] size missmatch&quot;</span>);
<a name="l00331"></a>00331 
<a name="l00332"></a>00332         eigenvalues.resize(n);
<a name="l00333"></a>00333         z.     <a class="code" href="class_chromosome_t__base.html#af222e374790b377bce4ce137b9c8b679">resize</a>(n);
<a name="l00334"></a>00334         pc.resize(n);
<a name="l00335"></a>00335         C.resize(n, n);
<a name="l00336"></a>00336         B.resize(n, n);
<a name="l00337"></a>00337 
<a name="l00338"></a>00338         u = <span class="keyword">new</span> <span class="keywordtype">double</span>[Shark::min(7u,n*n)];
<a name="l00339"></a>00339         <a class="code" href="_p_v_minterface_8cpp.html#a1198e984dc3eadf9f34c709a164689b0">pvm_upkdouble</a>(u, 7, 1);
<a name="l00340"></a>00340         sigma   = u[0];
<a name="l00341"></a>00341         psPrime = u[1];
<a name="l00342"></a>00342         cc      = u[2];
<a name="l00343"></a>00343         ccov    = u[3];
<a name="l00344"></a>00344         d       = u[4];
<a name="l00345"></a>00345         ps      = u[5];
<a name="l00346"></a>00346         cp      = u[6];
<a name="l00347"></a>00347 
<a name="l00348"></a>00348         <a class="code" href="_p_v_minterface_8cpp.html#a1198e984dc3eadf9f34c709a164689b0">pvm_upkdouble</a>(u, n, 1);
<a name="l00349"></a>00349         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) pc(i) = u[i];
<a name="l00350"></a>00350 
<a name="l00351"></a>00351         <a class="code" href="_p_v_minterface_8cpp.html#a1198e984dc3eadf9f34c709a164689b0">pvm_upkdouble</a>(u, n, 1);
<a name="l00352"></a>00352         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) eigenvalues(i) = u[i];
<a name="l00353"></a>00353 
<a name="l00354"></a>00354         <a class="code" href="_p_v_minterface_8cpp.html#a1198e984dc3eadf9f34c709a164689b0">pvm_upkdouble</a>(u, n*n, 1);
<a name="l00355"></a>00355         <span class="keywordflow">for</span> (i = 0; i &lt; n*n; i++) C.elem(i) = u[i];
<a name="l00356"></a>00356 
<a name="l00357"></a>00357         <a class="code" href="_p_v_minterface_8cpp.html#a1198e984dc3eadf9f34c709a164689b0">pvm_upkdouble</a>(u, n*n, 1);
<a name="l00358"></a>00358         <span class="keywordflow">for</span> (i = 0; i &lt; n*n; i++) B.elem(i) = u[i];
<a name="l00359"></a>00359 
<a name="l00360"></a>00360         <span class="keyword">delete</span>[] u;
<a name="l00361"></a>00361         <span class="keywordflow">return</span> 1;
<a name="l00362"></a>00362     };
<a name="l00363"></a>00363 
<a name="l00364"></a>00364 <span class="keyword">private</span>:
<a name="l00365"></a>00365     <span class="keywordtype">unsigned</span> n;     <span class="comment">// Dimension // problem dimension / chromosome length</span>
<a name="l00366"></a>00366     <span class="keywordtype">unsigned</span> lambda;      <span class="comment">//         // size of offspring population</span>
<a name="l00367"></a>00367     <span class="keywordtype">unsigned</span> i, j, k;   <span class="comment">//       // iterators</span>
<a name="l00368"></a>00368     <span class="keywordtype">double</span> sigma;       <span class="comment">// delta     // the current global stepsize</span>
<a name="l00369"></a>00369     <span class="keywordtype">double</span> psPrime; <span class="comment">//       // target success probability; strategy constant for global stepsize update</span>
<a name="l00370"></a>00370     <span class="keywordtype">double</span> cc;      <span class="comment">// c         // strategy constant for cma culmulation update</span>
<a name="l00371"></a>00371     <span class="keywordtype">double</span> ccov;        <span class="comment">//       // strategy constant for cma update</span>
<a name="l00372"></a>00372     <span class="keywordtype">double</span> d;
<a name="l00373"></a>00373     <span class="keywordtype">double</span> cp;
<a name="l00374"></a>00374     <span class="keywordtype">double</span> ps;      <span class="comment">// avsuccess // global stepsize culmulation path</span>
<a name="l00375"></a>00375     Array&lt;double&gt; pc;   <span class="comment">// s         // evo cumulation path</span>
<a name="l00376"></a>00376     Array2D&lt;double&gt; C;  <span class="comment">//       // the current covariance matrix</span>
<a name="l00377"></a>00377     Array2D&lt;double&gt; B;  <span class="comment">//       // eigenvector matrix C for offspring sampling</span>
<a name="l00378"></a>00378     Array&lt;double&gt; z;      <span class="comment">// standard normally distributed mutation vector</span>
<a name="l00379"></a>00379     Array&lt;double&gt; eigenvalues;       <span class="comment">// eigenvalue vector of C for offspring sampling</span>
<a name="l00380"></a>00380     Array&lt;double&gt; lastStep;      <span class="comment">//</span>
<a name="l00381"></a>00381 
<a name="l00382"></a>00382     <span class="keywordtype">unsigned</span>      noOffspringSinceUpdate;
<a name="l00383"></a>00383     <span class="keywordtype">double</span>        lambdaSucc;
<a name="l00384"></a>00384     <span class="keywordtype">double</span>        lowerBound;
<a name="l00385"></a>00385     <span class="keywordtype">bool</span> needCovarianceUpdate;
<a name="l00386"></a>00386 };
<a name="l00387"></a>00387 <span class="preprocessor">#endif</span>
<a name="l00388"></a>00388 <span class="preprocessor"></span>
<a name="l00389"></a>00389 
</pre></div></div>
</div>
</div>
</div>
</body></html>
