<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>EALib: pvmSphereGA.cpp</title>
<script type="text/javaScript" src="search/search.js"></script>
<link href="../css/main.css" rel="stylesheet" type="text/css"/>
</head>
<body id="type-b">

<div id="wrap">
<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
<div id="poweredby">
<img style="width: 95%;" src="../images/SharkLogo.png"/>
</div>		
  
<ul id="nav">
  <li class="first"><a href="../index.html">About Shark</a></li>
  <li><a href="#">Sourceforge</a>
  
  <ul>
    <li class="first"><a href="http://shark-project.sourceforge.net">Project Summary</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/files/">Downloads</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/develop">Subversion Repository</a></li>
  </ul>
  
</li>
<li class="first"><a href="../GettingStarted.html">Getting Started</a>
<li class="first"><a href="../Tutorials.html">Tutorials</a>
<li class="first"><a href="../FAQ.html">FAQ</a>

<li class="first"><a href="#">Main Modules</a>
<ul>
  <li class="first"><a href="../ReClaM/index.html">ReClaM</a>
  <li class="first"><a href="../EALib/index.html">EALib</a>
  <li class="first"><a href="../MOO-EALib/index.html">MOO-EALib</a>
  <li class="first"><a href="../Fuzzy/index.html">Fuzzy</a>
</ul>
</li>
<li class="first"><a href="#">Tools</a>
<ul>
  <li class="first"><a href="../Mixture/index.html">Mixture</a>
  <li><a href="../Array/index.html">Array</a>
  <li><a href="../Rng/index.html">Rng</a>
  <li><a href="../LinAlg/index.html">LinAlg</a>
  <li class="last"><a href="../FileUtil/index.html">FileUtil</a>		    
</ul>
</li>
</ul>
</div>

<!--<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
  <ul id="nav">
    <li><a href="../index.html"><span>Shark&nbsp;Main&nbsp;Page</span></a></li>
    <li><a href="../Array/index.html"><span>Array</span></a></li>
    <li><a href="../Rng/index.html"><span>Rng</span></a></li>
    <li><a href="../LinAlg/index.html"><span>LinAlg</span></a></li>
    <li><a href="../FileUtil/index.html"><span>FileUtil</span></a></li>
    <li><a href="../EALib/index.html"><span>EALib</span></a></li>
    <li><a href="../MOO-EALib/index.html"><span>MOO-EALib</span></a></li>
    <li class="active"><a href="../ReClaM/index.html"><span>ReClaM</span></a></li>
    <li><a href="../Fuzzy/index.html"><span>Fuzzy</span></a></li>
    <li><a href="../Mixture/index.html"><span>Mixture</span></a></li>
    <li><a href="../tutorials/index.html"><span>Tutorials</span></a></li>
    <li><a href="../faq/index.html"><span>FAQ</span></a></li>
  </ul>
 </div> -->
<!-- Generated by Doxygen 1.7.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>pvmSphereGA.cpp</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment">
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;iostream&gt;</span>

<span class="preprocessor">#include &lt;SharkDefs.h&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="_p_v_minterface_8h.html" title="This file serves as a dummy interface for the use of PVM with the EALib.">EALib/PVMinterface.h</a>&gt;</span>
<span class="preprocessor">#include &lt;Array/Array.h&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="_population_8h.html" title="Base class for populations of individuals in an evolutionary algorithm.">EALib/Population.h</a>&gt;</span>


<span class="comment">//</span>
<span class="comment">// HOWTO START THIS PARALLEL OPTIMIZATION EXAMPLE:</span>
<span class="comment">//</span>
<span class="comment">// Setup your PVM-environent and recompile this source.</span>
<span class="comment">// Start the pvm console, i.e., call the command</span>
<span class="comment">//  &#39;... /PVM-binpath/pvm&#39;.</span>
<span class="comment">// For example, add 3 hosts from your local network to your parallel virtual machine, i.e.,</span>
<span class="comment">//  &#39;add host1 host2 host3&#39;.</span>
<span class="comment">// Start the pvmSphereGA, i.e,</span>
<span class="comment">//  &#39;spawn -&gt; -4 ${SHARKHOME}/EALib/examples/pvmSphereGA_${ARCH} [random-seed]&#39;.</span>
<span class="comment">//</span>
<span class="comment">// Assuming equal random seed initializations, however, there might be different results compared to</span>
<span class="comment">// &#39;sphereGA&#39; or even to another restart of &#39;pvmSphereGA&#39;. This is due to different orderings of</span>
<span class="comment">// Individuals within the Population which might occur in the parallel case using the roulette wheel</span>
<span class="comment">// selection within the proportional selection scheme.</span>


<span class="comment">//=======================================================================</span>
<span class="comment">//=======================================================================</span>
<span class="comment">//</span>
<span class="comment">// Some tools for readers convenience</span>
<span class="comment">//</span>
<span class="comment">//=======================================================================</span>
<span class="comment">//=======================================================================</span>

<span class="comment">// fitness function: sphere model</span>
<span class="comment">//</span>
<span class="keywordtype">double</span> sphere(<span class="keyword">const</span> std::vector&lt; double &gt;&amp; x);

<span class="comment">// send-and-receive routine of the master process</span>
<span class="comment">//</span>
<span class="keywordtype">void</span> pvmMasterSendReceive(<a name="_a0"></a><a class="code" href="class_population.html" title="Base class for populations of individuals in an evolutionary algorithm.">Population</a>&amp; pop          ,
                          <span class="keywordtype">char</span>*       PVM_groupname,
                          <span class="keyword">const</span> <span class="keywordtype">int</span>   PVM_groupsize,
                          <span class="keyword">const</span> <span class="keywordtype">int</span>   msgTagSend   ,
                          <span class="keyword">const</span> <span class="keywordtype">int</span>   msgTagReceive
                         );

<span class="comment">// receive-evaluate-and-send routine of the slave processes</span>
<span class="comment">//</span>
<span class="keywordtype">void</span> pvmSlaveReceiveSend(<span class="keywordtype">char</span>*          PVM_groupname,
                         <span class="keyword">const</span> <span class="keywordtype">int</span>      PVM_groupsize,
                         <span class="keyword">const</span> <span class="keywordtype">int</span>      PVM_MasterID ,
                         <span class="keyword">const</span> <span class="keywordtype">int</span>      msgTagExit   ,
                         <span class="keyword">const</span> <span class="keywordtype">int</span>      msgTagSend   ,
                         <span class="keyword">const</span> <span class="keywordtype">int</span>      msgTagReceive,
                         <span class="keyword">const</span> <a name="_a1"></a><a class="code" href="class_interval.html" title="Interval [a, b] of the real numbers.">Interval</a> RangeOfValues,
                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NumOfBits    ,
                         <span class="keyword">const</span> <span class="keywordtype">bool</span>     UseGrayCode
                        );

<span class="comment">//=======================================================================</span>
<span class="comment">//=======================================================================</span>
<span class="comment">//</span>
<span class="comment">// Main programm</span>
<span class="comment">//</span>
<span class="comment">//=======================================================================</span>
<span class="comment">//=======================================================================</span>


<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argn, <span class="keywordtype">char</span> *argv[])
{

    std::cout &lt;&lt; <span class="stringliteral">&quot;# PVM process attemps to start ... &quot;</span>
    &lt;&lt; std::endl;

    <span class="comment">//</span>
    <span class="comment">// Parameter initialization</span>
    <span class="comment">//</span>

    <span class="comment">// PVM constants and variables</span>
    <span class="comment">//</span>
    <span class="keywordtype">char</span>*       PVM_groupname      = strdup(<span class="stringliteral">&quot;PVM-Test&quot;</span>);
    <span class="keyword">const</span> <span class="keywordtype">int</span>   PVM_groupsize      = 4;
    <span class="keyword">const</span> <span class="keywordtype">int</span>   PVM_sendExitTag    = 3;
    <span class="keyword">const</span> <span class="keywordtype">int</span>   PVM_sendFitnessTag = 2;
    <span class="keyword">const</span> <span class="keywordtype">int</span>   PVM_sendEvalTag    = 1;
    <span class="keyword">const</span> <span class="keywordtype">int</span>   PVM_MasterID       = 0;
    <span class="keywordtype">int</span> inum, tid;

    <span class="comment">// EALib constants and variables</span>
    <span class="comment">//</span>
    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> PopSize     = 50;
    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> Dimension   = 20;
    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NumOfBits   = 10;
    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> Iterations  = 2000;
    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> DspInterval = 10;
    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NElitists   = 1;
    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> Omega       = 5;
    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> CrossPoints = 2;
    <span class="keyword">const</span> <span class="keywordtype">double</span>   CrossProb   = 0.6;
    <span class="keyword">const</span> <span class="keywordtype">double</span>   FlipProb    = 1. / (Dimension * NumOfBits);
    <span class="keyword">const</span> <span class="keywordtype">bool</span>     UseGrayCode = <span class="keyword">true</span>;
    <span class="keyword">const</span> <a class="code" href="class_interval.html" title="Interval [a, b] of the real numbers.">Interval</a> RangeOfValues(-3, + 5);

    <span class="keywordtype">unsigned</span> i, t;

    <span class="keywordtype">int</span> myseed = (argn &gt; 1 ? atoi(argv[ 1 ]) : 1234);

    <span class="comment">//</span>
    <span class="comment">// Parallel processing</span>
    <span class="comment">//</span>

    <span class="comment">// require a unique task-ID and apply for the PVM-group</span>
    <span class="comment">//</span>
    tid  = <a name="a2"></a><a class="code" href="_p_v_minterface_8cpp.html#ad31b665d667c3fa8f36d12b01c7e007a">pvm_mytid</a>();

    <span class="keywordflow">if</span> (tid &lt; 0) {
        <span class="keywordflow">throw</span> SHARKEXCEPTION(<span class="stringliteral">&quot;There is something going wrong ... \nmaybe you forgot to spawn processes from the pvm-console.\nPlease try the following. \nStart the pvm-console, i.e., call the command &#39;... /$(PVM-binpath)/pvm&#39;.\nAfter the pvm-console has started, for example, add 3 hosts from your local network\nto your parallel virtual machine (PVM), i.e., call &#39;add host1 host2 host3&#39;.\nStart this program from the pvm console, i.e, call\n&#39;spawn -&gt; -4 $(SHARKHOME)/EALib/examples/pvmSphereGa&lt;extension for your operating system&gt; [optional random-seed]&#39;.&quot;</span>);
        <span class="comment">//      exit(-1);</span>
    }
    <span class="keywordflow">else</span>
        std::cout &lt;&lt; <span class="stringliteral">&quot;# ... process with TID &quot;</span> &lt;&lt; tid &lt;&lt; <span class="stringliteral">&quot; started&quot;</span>
        &lt;&lt; <span class="stringliteral">&quot; successfully. Please hold on for results.&quot;</span>
        &lt;&lt; std::endl;

    inum = <a name="a3"></a><a class="code" href="_p_v_minterface_8cpp.html#a84c597d789a0fd4387d099997c3cd9a1">pvm_joingroup</a>(PVM_groupname);

    <span class="comment">// synchronize all processes</span>
    <span class="comment">//</span>
    <a name="a4"></a><a class="code" href="_p_v_minterface_8cpp.html#ab6feca811e7bf8acbd734754bcede361">pvm_barrier</a>(PVM_groupname, PVM_groupsize);

    <span class="comment">// distinction between master and slave processes</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (inum == PVM_MasterID) {
        <span class="comment">//</span>
        <span class="comment">//  Master process</span>
        <span class="comment">//</span>
        Rng::seed(myseed);

        <span class="comment">// define populations</span>
        <span class="comment">//</span>
        <span class="keyword">static</span> <a class="code" href="class_population.html" title="Base class for populations of individuals in an evolutionary algorithm.">Population</a> parents(PopSize, <a name="_a5"></a><a class="code" href="class_chromosome_t_3_01bool_01_4.html" title="chromosome based on bits">ChromosomeT&lt; bool &gt;</a>(Dimension * NumOfBits));
        <span class="keyword">static</span> <a class="code" href="class_population.html" title="Base class for populations of individuals in an evolutionary algorithm.">Population</a> offspring(PopSize, <a class="code" href="class_chromosome_t_3_01bool_01_4.html" title="chromosome based on bits">ChromosomeT&lt; bool &gt;</a>(Dimension * NumOfBits));

        <span class="comment">// scaling window</span>
        <span class="comment">//</span>
        std::vector&lt; double &gt; window(Omega);

        <span class="comment">// minimization task</span>
        <span class="comment">//</span>
        parents  .setMinimize();
        offspring.setMinimize();

        <span class="comment">// initialize all chromosomes of parent population</span>
        <span class="comment">//</span>
        <span class="keywordflow">for</span> (i = 0; i &lt; parents.size(); ++i)
            <span class="keyword">dynamic_cast&lt;</span> <a class="code" href="class_chromosome_t_3_01bool_01_4.html" title="chromosome based on bits">ChromosomeT&lt; bool &gt;</a>&amp; <span class="keyword">&gt;</span>(parents[ i ][ 0 ]).<a name="a6"></a><a class="code" href="class_chromosome_t_3_01bool_01_4.html#ab65bb7ab83f3325f614dc4a3a6f23500">initialize</a>();

        <span class="comment">// send and receive individuals</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (NElitists &gt; 0)
            pvmMasterSendReceive(parents, PVM_groupname, PVM_groupsize, PVM_sendEvalTag, PVM_sendFitnessTag);

        <span class="keywordflow">for</span> (t = 0; t &lt; Iterations; ++t) {
            <span class="comment">// recombine by crossing over two parents</span>
            <span class="comment">//</span>
            offspring = parents;
            <span class="keywordflow">for</span> (i = 0; i &lt; offspring.size() - 1; i += 2)
                <span class="keywordflow">if</span> (Rng::coinToss(CrossProb))
                    offspring[ i ][ 0 ].crossover(offspring[ i+1 ][ 0 ],
                                                  CrossPoints);

            <span class="comment">// mutate by flipping bits</span>
            <span class="comment">//</span>
            <span class="keywordflow">for</span> (i = 0; i &lt; offspring.size(); ++i)
                <span class="keyword">dynamic_cast&lt;</span> <a class="code" href="class_chromosome_t_3_01bool_01_4.html" title="chromosome based on bits">ChromosomeT&lt; bool &gt;</a>&amp; <span class="keyword">&gt;</span>(offspring[ i ][ 0 ]).<a name="a7"></a><a class="code" href="class_chromosome_t_3_01bool_01_4.html#a45468a5813cf3c5dc5db1a068d122a43">flip</a>(FlipProb);

            <span class="comment">// send and receive individuals</span>
            <span class="comment">//</span>
            pvmMasterSendReceive(offspring,
                                 PVM_groupname,
                                 PVM_groupsize,
                                 PVM_sendEvalTag,
                                 PVM_sendFitnessTag);

            <span class="comment">// scale fitness values and use proportional selection</span>
            <span class="comment">//</span>
            offspring.linearDynamicScaling(window, t);
            parents.selectProportional(offspring, NElitists);

            <span class="comment">// print out best value found so far</span>
            <span class="comment">//</span>
            <span class="keywordflow">if</span> (t % DspInterval == 0)
                std::cout &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;\tbest value = &quot;</span>
                &lt;&lt; parents.best().fitnessValue() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
        }

        <span class="comment">// exit slave processess</span>
        <span class="comment">//</span>
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; PVM_groupsize; i++) {
            <a name="a8"></a><a class="code" href="_p_v_minterface_8cpp.html#a63729c301ce80b629dabff4dce2e311c">pvm_initsend</a>(<a name="a9"></a><a class="code" href="_p_v_minterface_8h.html#afc6decb90a987ce3c94cd51d4fca6dff">PvmDataDefault</a>);
            <a name="a10"></a><a class="code" href="_p_v_minterface_8cpp.html#a5738dc31578bde61bda28e4e06237fda">pvm_send</a>(<a name="a11"></a><a class="code" href="_p_v_minterface_8cpp.html#a359bd3c1246b1b98dc121332f8f56f85">pvm_gettid</a>(PVM_groupname, i), PVM_sendExitTag);
        }
    }
    <span class="keywordflow">else</span> {
        <span class="comment">//</span>
        <span class="comment">//  Slave processess</span>
        <span class="comment">//</span>

        <span class="comment">// Note, if random sampling is required it should be ensured</span>
        <span class="comment">// that all slaves apply different random seed initializations</span>
        <span class="comment">//</span>
        <span class="comment">// Rng::seed(myseed + inum);</span>

        <span class="comment">// receive, evaluate and send parents (only needed for elitist strategy)</span>
        <span class="comment">//</span>
        pvmSlaveReceiveSend(PVM_groupname,
                            PVM_groupsize,
                            PVM_MasterID,
                            PVM_sendExitTag,
                            PVM_sendFitnessTag,
                            PVM_sendEvalTag,
                            RangeOfValues,
                            NumOfBits,
                            UseGrayCode
                           );
    }

    <span class="comment">// synchronize all processes</span>
    <span class="comment">//</span>
    <a class="code" href="_p_v_minterface_8cpp.html#ab6feca811e7bf8acbd734754bcede361">pvm_barrier</a>(PVM_groupname, PVM_groupsize);

    <span class="comment">//</span>
    <span class="comment">// Finish all processes</span>
    <span class="comment">//</span>
    std::cout &lt;&lt; <span class="stringliteral">&quot;# PVM process with TID &quot;</span> &lt;&lt; tid &lt;&lt; <span class="stringliteral">&quot; will halt now... &quot;</span> &lt;&lt; std::endl
    &lt;&lt; std::endl;

    <a name="a12"></a><a class="code" href="_p_v_minterface_8cpp.html#aedb6ec3cb5523c151be8a5c619226375">pvm_exit</a>();
}



<span class="comment">//=======================================================================</span>
<span class="comment">//</span>
<span class="comment">// fitness function: sphere model</span>
<span class="comment">//</span>
<span class="keywordtype">double</span> sphere(<span class="keyword">const</span> std::vector&lt; double &gt;&amp; x)
{
    <span class="keywordtype">unsigned</span> i;
    <span class="keywordtype">double</span>   sum;
    <span class="keywordflow">for</span> (sum = 0., i = 0; i &lt; x.size(); i++)
        sum += Shark::sqr(x[ i ]);
    <span class="keywordflow">return</span> sum;
}

<span class="comment">//=======================================================================</span>
<span class="comment">//</span>
<span class="comment">// send and receive routine of the master</span>
<span class="comment">//</span>
<span class="keywordtype">void</span> pvmMasterSendReceive(<a class="code" href="class_population.html" title="Base class for populations of individuals in an evolutionary algorithm.">Population</a>&amp; pop          ,
                          <span class="keywordtype">char</span>*       PVM_groupname,
                          <span class="keyword">const</span> <span class="keywordtype">int</span>   PVM_groupsize,
                          <span class="keyword">const</span> <span class="keywordtype">int</span>   msgTagSend   ,
                          <span class="keyword">const</span> <span class="keywordtype">int</span>   msgTagReceive
                         )
{
    <span class="keywordtype">unsigned</span> i;

    <span class="keywordflow">for</span> (i = 0; i &lt; pop.<a name="a13"></a><a class="code" href="class_population.html#afd59ccfaf65813549e6ea756ef0fb54b">size</a>(); ++i) {
        <span class="comment">// send all individuals of pop to slave processes for evaluation</span>
        <span class="comment">//</span>
        <a class="code" href="_p_v_minterface_8cpp.html#a63729c301ce80b629dabff4dce2e311c">pvm_initsend</a>(<a class="code" href="_p_v_minterface_8h.html#afc6decb90a987ce3c94cd51d4fca6dff">PvmDataDefault</a>);
        pop[i].pvm_pkind();
        <a class="code" href="_p_v_minterface_8cpp.html#a5738dc31578bde61bda28e4e06237fda">pvm_send</a>(<a class="code" href="_p_v_minterface_8cpp.html#a359bd3c1246b1b98dc121332f8f56f85">pvm_gettid</a>(PVM_groupname, i % (PVM_groupsize - 1) + 1), msgTagSend);
    }

    <span class="keywordtype">int</span> bufid = 0; <span class="keywordtype">int</span> counter = pop.<a class="code" href="class_population.html#afd59ccfaf65813549e6ea756ef0fb54b">size</a>();

    <span class="keywordflow">while</span> (counter &gt; 0) {
        <span class="comment">// check whether any individual has returned from parallel evaluation</span>
        <span class="comment">//</span>
        <span class="keywordflow">do</span> {
            bufid = <a name="a14"></a><a class="code" href="_p_v_minterface_8cpp.html#a31127646c1b5952e60bd63314bb5e1f5">pvm_probe</a>(-1, msgTagReceive);
        }
        <span class="keywordflow">while</span> (bufid == 0);

        <span class="comment">// in case, integrate the evaluated individual in the Population pop</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (bufid &gt; 0) {
            <span class="comment">// extract obligatory information from the message</span>
            <span class="comment">//</span>
            <span class="keywordtype">int</span> bytes; <span class="keywordtype">int</span> msgtag; <span class="keywordtype">int</span> tid;
            <a name="a15"></a><a class="code" href="_p_v_minterface_8cpp.html#a1e6b4d34400a091715109543e99b4d61">pvm_bufinfo</a>(bufid, &amp;bytes, &amp;msgtag, &amp;tid);

            <span class="comment">// receive individual and overwrite not evaluated individuals with evaluated ones</span>
            <span class="comment">//</span>
            <a name="a16"></a><a class="code" href="_p_v_minterface_8cpp.html#a526013dd1ae8fe075a2d19a952c2702b">pvm_recv</a>(tid, msgtag);
            pop[pop.<a class="code" href="class_population.html#afd59ccfaf65813549e6ea756ef0fb54b">size</a>()-counter].pvm_upkind();
            counter--;
        }
    }
}

<span class="comment">//=======================================================================</span>
<span class="comment">//</span>
<span class="comment">// receive, evaluate and send routine of the slave</span>
<span class="comment">//</span>
<span class="keywordtype">void</span> pvmSlaveReceiveSend(<span class="keywordtype">char</span>*          PVM_groupname,
                         <span class="keyword">const</span> <span class="keywordtype">int</span>      PVM_groupsize,
                         <span class="keyword">const</span> <span class="keywordtype">int</span>      PVM_MasterID ,
                         <span class="keyword">const</span> <span class="keywordtype">int</span>      msgTagExit   ,
                         <span class="keyword">const</span> <span class="keywordtype">int</span>      msgTagSend   ,
                         <span class="keyword">const</span> <span class="keywordtype">int</span>      msgTagReceive,
                         <span class="keyword">const</span> <a class="code" href="class_interval.html" title="Interval [a, b] of the real numbers.">Interval</a> RangeOfValues,
                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NumOfBits    ,
                         <span class="keyword">const</span> <span class="keywordtype">bool</span>     UseGrayCode
                        )
{
    <span class="keywordtype">int</span> bufid, bufidExit = 0;

    <span class="keywordflow">while</span> (bufidExit == 0) {
        <span class="comment">// check whether any individual has arrived from the master process</span>
        <span class="comment">//</span>
        <span class="keywordflow">do</span> {
            bufid     = <a class="code" href="_p_v_minterface_8cpp.html#a31127646c1b5952e60bd63314bb5e1f5">pvm_probe</a>(<a class="code" href="_p_v_minterface_8cpp.html#a359bd3c1246b1b98dc121332f8f56f85">pvm_gettid</a>(PVM_groupname, PVM_MasterID), msgTagReceive);
            bufidExit = <a class="code" href="_p_v_minterface_8cpp.html#a31127646c1b5952e60bd63314bb5e1f5">pvm_probe</a>(<a class="code" href="_p_v_minterface_8cpp.html#a359bd3c1246b1b98dc121332f8f56f85">pvm_gettid</a>(PVM_groupname, PVM_MasterID), msgTagExit)   ;
            <span class="keywordflow">if</span> (bufidExit != 0)
                <a class="code" href="_p_v_minterface_8cpp.html#a526013dd1ae8fe075a2d19a952c2702b">pvm_recv</a>(<a class="code" href="_p_v_minterface_8cpp.html#a359bd3c1246b1b98dc121332f8f56f85">pvm_gettid</a>(PVM_groupname, PVM_MasterID), msgTagExit)              ;
        }
        <span class="keywordflow">while</span> ((bufid == 0) &amp;&amp; (bufidExit == 0));

        <span class="comment">// in case, evaluate individual and return it to the sender</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (bufid != 0) {
            <span class="comment">// extract obligatory information from the message</span>
            <span class="comment">//</span>
            <span class="keywordtype">int</span> bytes; <span class="keywordtype">int</span> msgtag; <span class="keywordtype">int</span> tid;
            <a class="code" href="_p_v_minterface_8cpp.html#a1e6b4d34400a091715109543e99b4d61">pvm_bufinfo</a>(bufid, &amp;bytes, &amp;msgtag, &amp;tid);

            <span class="comment">// receive individual</span>
            <span class="comment">//</span>
            <a name="_a17"></a><a class="code" href="class_individual.html" title="Base class for individuals in a population.">Individual</a> ind(<a class="code" href="class_chromosome_t_3_01bool_01_4.html" title="chromosome based on bits">ChromosomeT&lt;bool&gt;</a>(1));
            <a class="code" href="_p_v_minterface_8cpp.html#a526013dd1ae8fe075a2d19a952c2702b">pvm_recv</a>(tid, msgtag);
            ind.pvm_upkind();

            <span class="comment">// evaluate objective function</span>
            <span class="comment">//</span>
            <a name="_a18"></a><a class="code" href="class_chromosome_t_3_01double_01_4.html" title="chromosome based on double numbers">ChromosomeT&lt; double &gt;</a> dblchrom;
            dblchrom.<a name="a19"></a><a class="code" href="class_chromosome_t_3_01double_01_4.html#a965c5c306fe83edf3a12c13dc1d25a9f">decodeBinary</a>(ind[ 0 ], RangeOfValues, NumOfBits, UseGrayCode);
            ind.setFitness(sphere(dblchrom));

            <span class="comment">// return evaluated individua to the sender</span>
            <span class="comment">//</span>
            <a class="code" href="_p_v_minterface_8cpp.html#a63729c301ce80b629dabff4dce2e311c">pvm_initsend</a>(<a class="code" href="_p_v_minterface_8h.html#afc6decb90a987ce3c94cd51d4fca6dff">PvmDataDefault</a>);
            ind.pvm_pkind();
            <a class="code" href="_p_v_minterface_8cpp.html#a5738dc31578bde61bda28e4e06237fda">pvm_send</a>(tid, msgTagSend);
        }
    }
}



</pre></div> </div>
</div>
</div>
</div>
</body></html>
