<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ReClaM: CrossEntropyIndependent Class Reference</title>
<script type="text/javaScript" src="search/search.js"></script>
<link href="../css/main.css" rel="stylesheet" type="text/css"/>
</head>
<body id="type-b">

<div id="wrap">
<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
<div id="poweredby">
<img style="width: 95%;" src="../images/SharkLogo.png"/>
</div>		
  
<ul id="nav">
  <li class="first"><a href="../index.html">About Shark</a></li>
  <li><a href="#">Sourceforge</a>
  
  <ul>
    <li class="first"><a href="http://shark-project.sourceforge.net">Project Summary</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/files/">Downloads</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/develop">Subversion Repository</a></li>
  </ul>
  
</li>
<li class="first"><a href="../GettingStarted.html">Getting Started</a>
<li class="first"><a href="../Tutorials.html">Tutorials</a>
<li class="first"><a href="../FAQ.html">FAQ</a>

<li class="first"><a href="#">Main Modules</a>
<ul>
  <li class="first"><a href="../ReClaM/index.html">ReClaM</a>
  <li class="first"><a href="../EALib/index.html">EALib</a>
  <li class="first"><a href="../MOO-EALib/index.html">MOO-EALib</a>
  <li class="first"><a href="../Fuzzy/index.html">Fuzzy</a>
</ul>
</li>
<li class="first"><a href="#">Tools</a>
<ul>
  <li class="first"><a href="../Mixture/index.html">Mixture</a>
  <li><a href="../Array/index.html">Array</a>
  <li><a href="../Rng/index.html">Rng</a>
  <li><a href="../LinAlg/index.html">LinAlg</a>
  <li class="last"><a href="../FileUtil/index.html">FileUtil</a>		    
</ul>
</li>
</ul>
</div>

<!--<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
  <ul id="nav">
    <li><a href="../index.html"><span>Shark&nbsp;Main&nbsp;Page</span></a></li>
    <li><a href="../Array/index.html"><span>Array</span></a></li>
    <li><a href="../Rng/index.html"><span>Rng</span></a></li>
    <li><a href="../LinAlg/index.html"><span>LinAlg</span></a></li>
    <li><a href="../FileUtil/index.html"><span>FileUtil</span></a></li>
    <li><a href="../EALib/index.html"><span>EALib</span></a></li>
    <li><a href="../MOO-EALib/index.html"><span>MOO-EALib</span></a></li>
    <li class="active"><a href="../ReClaM/index.html"><span>ReClaM</span></a></li>
    <li><a href="../Fuzzy/index.html"><span>Fuzzy</span></a></li>
    <li><a href="../Mixture/index.html"><span>Mixture</span></a></li>
    <li><a href="../tutorials/index.html"><span>Tutorials</span></a></li>
    <li><a href="../faq/index.html"><span>FAQ</span></a></li>
  </ul>
 </div> -->
<!-- Generated by Doxygen 1.7.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<h1>CrossEntropyIndependent Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="CrossEntropyIndependent" --><!-- doxytag: inherits="ErrorFunction" -->
<p>Error measure for classification tasks of non exclusive attributes that can be used for model training.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_cross_entropy_independent_8h_source.html">CrossEntropyIndependent.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CrossEntropyIndependent:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_cross_entropy_independent.png" usemap="#CrossEntropyIndependent_map" alt=""/>
  <map id="CrossEntropyIndependent_map" name="CrossEntropyIndependent_map">
<area href="class_error_function.html" alt="ErrorFunction" shape="rect" coords="0,0,158,24"/>
</map>
 </div></div>

<p><a href="class_cross_entropy_independent-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_cross_entropy_independent.html#a8455ba602cb3641bcfc01afff40da70a">error</a> (<a class="el" href="class_model.html">Model</a> &amp;model, const Array&lt; double &gt; &amp;in, const Array&lt; double &gt; &amp;target)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the <a class="el" href="class_cross_entropy_independent.html" title="Error measure for classification tasks of non exclusive attributes that can be used for model trainin...">CrossEntropyIndependent</a> error.  <a href="#a8455ba602cb3641bcfc01afff40da70a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_cross_entropy_independent.html#ae4ce4819f38eb750d65de2c5c32a663c">errorDerivative</a> (<a class="el" href="class_model.html">Model</a> &amp;model, const Array&lt; double &gt; &amp;in, const Array&lt; double &gt; &amp;target, Array&lt; double &gt; &amp;derivative)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the derivatives of the <a class="el" href="class_cross_entropy_independent.html" title="Error measure for classification tasks of non exclusive attributes that can be used for model trainin...">CrossEntropyIndependent</a> error (see <a class="el" href="class_cross_entropy_independent.html#a8455ba602cb3641bcfc01afff40da70a" title="Calculates the CrossEntropyIndependent error.">error</a>) with respect to the parameters <a class="el" href="class_model_interface.html#a5f17b448e42d1c546e369163679b3355" title="Reference to parameter.">ModelInterface::w</a>.  <a href="#ae4ce4819f38eb750d65de2c5c32a663c"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Error measure for classification tasks of non exclusive attributes that can be used for model training. </p>
<p>If your model should return a vector whose components are connected to multiple mutually independent attributes and the <em>k-th</em> component of the output vector is representing the probability of the presence of the <em>k-th</em> attribute given any input vector, 'CrossEntropyIndependent' is the adequate error measure for model-training. For <em>C&gt;1</em>, dimension of model's output and every output dimension represents a single attribute or class respectively, it follows the formular </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ E = - \sum_{i=1}^N \sum_{k=1}^{C} \{tar^i_k \ln model_k(in^i) + (1-tar^i_k) \ln (1-model_k(in^i))\} \]" src="form_156.png"/>
</p>
<p> where <em>i</em> runs over all input patterns. This error functional can be derivated and so used for training. In case of only one single output dimension 'CrossEntropyIndependent' returns actually the true cross entropy for two classes, using the formalism </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ E = - \sum_{i=1}^N \{tar^i \ln model(in^i) + (1-tar^i) \ln (1-model(in^i))\} \]" src="form_157.png"/>
</p>
<p> For theoretical reasons it is suggested to use for neural networks the logistic sigmoid activation function at the output neurons. However, actually every sigmoid activation could be applied to the output neurons as far as the image of this function is identical to the intervall <em></em>[0,1]. In this implementation every target value to be chosen from {0,1} (binary encoding). For detailed information refer to (C.M. Bishop, Neural Networks for Pattern Recognition, Clarendon Press 1996, Chapter 6.8.)</p>
<p>This implementation of the cross entropy performs less efficient than the implemetation given in 'DF_CrossEntropyIndependent.h' for more than one output dimensions, if standard model classes as 'FFNet' are simultaneously linked, because redundant calculations of the outer derivatives are not circumvented.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>M. Huesken </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl class="user"><dt><b>Changes:</b></dt><dd>Revision 2003/06/03 (S. Wiegand): bugs in formulars corrected</dd></dl>
<dl class="user"><dt><b>Status:</b></dt><dd>stable </dd></dl>

<p>Definition at line <a class="el" href="_cross_entropy_independent_8h_source.html#l00131">131</a> of file <a class="el" href="_cross_entropy_independent_8h_source.html">CrossEntropyIndependent.h</a>.</p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a8455ba602cb3641bcfc01afff40da70a"></a><!-- doxytag: member="CrossEntropyIndependent::error" ref="a8455ba602cb3641bcfc01afff40da70a" args="(Model &amp;model, const Array&lt; double &gt; &amp;in, const Array&lt; double &gt; &amp;target)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CrossEntropyIndependent::error </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_model.html">Model</a> &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates the <a class="el" href="class_cross_entropy_independent.html" title="Error measure for classification tasks of non exclusive attributes that can be used for model trainin...">CrossEntropyIndependent</a> error. </p>
<p>Calculates the <a class="el" href="class_cross_entropy_independent.html" title="Error measure for classification tasks of non exclusive attributes that can be used for model trainin...">CrossEntropyIndependent</a> error function for <em>N</em> patterns and <em>C&gt;1</em> independent attributes within the output vector via </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ E = - \sum_{i=1}^N \sum_{k=1}^{C} \{tar^i_k \ln model_k(in^i) + (1-tar^i_k) \ln (1-model_k(in^i))\} \]" src="form_156.png"/>
</p>
<p> or the true cross entropy for only one single output dimension via </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ E = - \sum_{i=1}^N \{tar^i \ln model(in^i) + (1-tar^i) \ln (1-model(in^i))\} \]" src="form_157.png"/>
</p>
 <dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>Input vector for the model. </td></tr>
    <tr><td class="paramname">target</td><td>Target vector. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The error <em>E</em>.</dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>M. Huesken, S. Wiegand </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>1999, 2003 </dd></dl>

<p>Implements <a class="el" href="class_error_function.html#a116fe3002d98786b63ccc5f1a480ac14">ErrorFunction</a>.</p>

<p>Definition at line <a class="el" href="_cross_entropy_independent_8h_source.html#l00162">162</a> of file <a class="el" href="_cross_entropy_independent_8h_source.html">CrossEntropyIndependent.h</a>.</p>

<p>References <a class="el" href="_model_8h_source.html#l00336">Model::getOutputDimension()</a>.</p>

</div>
</div>
<a class="anchor" id="ae4ce4819f38eb750d65de2c5c32a663c"></a><!-- doxytag: member="CrossEntropyIndependent::errorDerivative" ref="ae4ce4819f38eb750d65de2c5c32a663c" args="(Model &amp;model, const Array&lt; double &gt; &amp;in, const Array&lt; double &gt; &amp;target, Array&lt; double &gt; &amp;derivative)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CrossEntropyIndependent::errorDerivative </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_model.html">Model</a> &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>derivative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates the derivatives of the <a class="el" href="class_cross_entropy_independent.html" title="Error measure for classification tasks of non exclusive attributes that can be used for model trainin...">CrossEntropyIndependent</a> error (see <a class="el" href="class_cross_entropy_independent.html#a8455ba602cb3641bcfc01afff40da70a" title="Calculates the CrossEntropyIndependent error.">error</a>) with respect to the parameters <a class="el" href="class_model_interface.html#a5f17b448e42d1c546e369163679b3355" title="Reference to parameter.">ModelInterface::w</a>. </p>
<p>Calculates the <a class="el" href="class_cross_entropy_independent.html" title="Error measure for classification tasks of non exclusive attributes that can be used for model trainin...">CrossEntropyIndependent</a> error derivative for <em>N</em> patterns and <em>C&gt;1</em> independent attributes within the output vector corresponding to model parameter <em>w</em> via </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial E}{\partial w} = - \sum_{i=1}^N \sum_{k=1}^{C} \left\{ \frac{tar^i_k - model_k(in^i)}{model_k(in^i)\cdot(1-model_k(in^i))} \cdot\frac{\partial model_k(in^i)}{\partial w}\right\} \]" src="form_158.png"/>
</p>
<p> or the derivative of the true cross entropy for only one single output dimension via </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial E}{\partial w} = - \sum_{i=1}^N \left\{ \frac{tar^i - model(in^i)}{model(in^i)\cdot(1-model(in^i))} \cdot\frac{\partial model(in^i)}{\partial w}\right\} \]" src="form_155.png"/>
</p>
<p> Usually, as a byproduct of the calculation of the derivative one gets the <a class="el" href="class_cross_entropy_independent.html" title="Error measure for classification tasks of non exclusive attributes that can be used for model trainin...">CrossEntropyIndependent</a> error itself very efficiently. Therefore, the method <a class="el" href="class_cross_entropy_independent.html#a8455ba602cb3641bcfc01afff40da70a" title="Calculates the CrossEntropyIndependent error.">error</a> gives back this value. This additional effect can be switched of by means of the third parameter (returnError = false).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>Input vector for the model. </td></tr>
    <tr><td class="paramname">target</td><td>Target vector. </td></tr>
    <tr><td class="paramname">returnError</td><td>Determines whether or not to calculate the cross entropy error itself. By default the error is calculated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The <a class="el" href="class_cross_entropy_independent.html" title="Error measure for classification tasks of non exclusive attributes that can be used for model trainin...">CrossEntropyIndependent</a> error if <em>returnError</em> is set to "true", "-1" otherwise.</dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>M. Huesken </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl class="user"><dt><b>Changes</b></dt><dd>Revision 2003/06/03 (S. Wiegand): bugs in formulars corrected</dd></dl>
<dl class="user"><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>Reimplemented from <a class="el" href="class_error_function.html#a1d7581c61746f51aa96f74fc17a30d55">ErrorFunction</a>.</p>

<p>Definition at line <a class="el" href="_cross_entropy_independent_8h_source.html#l00263">263</a> of file <a class="el" href="_cross_entropy_independent_8h_source.html">CrossEntropyIndependent.h</a>.</p>

<p>References <a class="el" href="_model_8h_source.html#l00336">Model::getOutputDimension()</a>, <a class="el" href="_model_8h_source.html#l00343">Model::getParameterDimension()</a>, <a class="el" href="_b_f_g_s_8cpp_source.html#l00321">i</a>, and <a class="el" href="_model_8cpp_source.html#l00056">Model::modelDerivative()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="_cross_entropy_independent_8h_source.html">CrossEntropyIndependent.h</a></li>
</ul>
</div>
</div>
</div>
</body></html>
