<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ReClaM: VarianceEstimator Class Reference</title>
<script type="text/javaScript" src="search/search.js"></script>
<link href="../css/main.css" rel="stylesheet" type="text/css"/>
</head>
<body id="type-b">

<div id="wrap">
<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
<div id="poweredby">
<img style="width: 95%;" src="../images/SharkLogo.png"/>
</div>		
  
<ul id="nav">
  <li class="first"><a href="../index.html">About Shark</a></li>
  <li><a href="#">Sourceforge</a>
  
  <ul>
    <li class="first"><a href="http://shark-project.sourceforge.net">Project Summary</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/files/">Downloads</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/develop">Subversion Repository</a></li>
  </ul>
  
</li>
<li class="first"><a href="../GettingStarted.html">Getting Started</a>
<li class="first"><a href="../Tutorials.html">Tutorials</a>
<li class="first"><a href="../FAQ.html">FAQ</a>

<li class="first"><a href="#">Main Modules</a>
<ul>
  <li class="first"><a href="../ReClaM/index.html">ReClaM</a>
  <li class="first"><a href="../EALib/index.html">EALib</a>
  <li class="first"><a href="../MOO-EALib/index.html">MOO-EALib</a>
  <li class="first"><a href="../Fuzzy/index.html">Fuzzy</a>
</ul>
</li>
<li class="first"><a href="#">Tools</a>
<ul>
  <li class="first"><a href="../Mixture/index.html">Mixture</a>
  <li><a href="../Array/index.html">Array</a>
  <li><a href="../Rng/index.html">Rng</a>
  <li><a href="../LinAlg/index.html">LinAlg</a>
  <li class="last"><a href="../FileUtil/index.html">FileUtil</a>		    
</ul>
</li>
</ul>
</div>

<!--<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
  <ul id="nav">
    <li><a href="../index.html"><span>Shark&nbsp;Main&nbsp;Page</span></a></li>
    <li><a href="../Array/index.html"><span>Array</span></a></li>
    <li><a href="../Rng/index.html"><span>Rng</span></a></li>
    <li><a href="../LinAlg/index.html"><span>LinAlg</span></a></li>
    <li><a href="../FileUtil/index.html"><span>FileUtil</span></a></li>
    <li><a href="../EALib/index.html"><span>EALib</span></a></li>
    <li><a href="../MOO-EALib/index.html"><span>MOO-EALib</span></a></li>
    <li class="active"><a href="../ReClaM/index.html"><span>ReClaM</span></a></li>
    <li><a href="../Fuzzy/index.html"><span>Fuzzy</span></a></li>
    <li><a href="../Mixture/index.html"><span>Mixture</span></a></li>
    <li><a href="../tutorials/index.html"><span>Tutorials</span></a></li>
    <li><a href="../faq/index.html"><span>FAQ</span></a></li>
  </ul>
 </div> -->
<!-- Generated by Doxygen 1.7.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a>  </div>
  <div class="headertitle">
<h1>VarianceEstimator Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="VarianceEstimator" -->
<p>Offers the methods to deal with active learning of a neural network.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_variance_estimator_8h_source.html">VarianceEstimator.h</a>&gt;</code></p>

<p><a href="class_variance_estimator-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_variance_estimator.html#aea522ef604104c2ddab4d2616e30802e">estimateFisherInformation</a> (<a class="el" href="class_model.html">Model</a> &amp;model, const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;outputA, Array&lt; double &gt; &amp;infMatA)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The Fisher information matrix is estimated.  <a href="#aea522ef604104c2ddab4d2616e30802e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_variance_estimator.html#a5ad1079b076b10035dd4a04e0d8d2f4c">estimateInvFisher</a> (<a class="el" href="class_model.html">Model</a> &amp;model, const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;outputA, Array&lt; double &gt; &amp;invInfMatA, Array&lt; double &gt; &amp;transInvInfMatA, double &amp;s2A)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimates the inverse Fisher information matrix and other values used for quantifying changes in variance due to active learning.  <a href="#a5ad1079b076b10035dd4a04e0d8d2f4c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_variance_estimator.html#a30e99fc49668973fd09b5e76f534a175">estimateVariance</a> (<a class="el" href="class_model.html">Model</a> &amp;model, const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;invInfMatA)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The estimated output variance of the network for one input pattern is returned.  <a href="#a30e99fc49668973fd09b5e76f534a175"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_variance_estimator.html#ac13748ca912f361a297d313f82560722">estimateVarianceChange</a> (<a class="el" href="class_model.html">Model</a> &amp;model, const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;invInfMatA, const Array&lt; double &gt; &amp;transInvInfMatA, double s2A)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimates the change in the output variance after an active learning step.  <a href="#ac13748ca912f361a297d313f82560722"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_variance_estimator.html#a9b522838819bbfd5c32d122777ca7613">overallVariance</a> (<a class="el" href="class_model.html">Model</a> &amp;model, const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;outputA)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The estimated output variance of the network for all input patterns is returned.  <a href="#a9b522838819bbfd5c32d122777ca7613"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Offers the methods to deal with active learning of a neural network. </p>
<p>Most neural networks are used as passive learners, i.e. they will work on a fixed training set. In natural learning problems, however, the learner can gather new information from its environment to improve the learning process. Using active learning in connection with neural networks, the network is allowed to select a new training input <img class="formulaInl" alt="$\tilde{x}$" src="form_72.png"/> at each time step. <br/>
 To achieve a real improvement of the learning process, the selected new input is not chosen by random. The goal is to chose an input, that minimizes the expectation of the learner's mean squared error. So you will find methods here, that will estimate the output variance of the network, when adding a new example to the training set. <br/>
 For more details about active learning in neural networks and the formulas used here for the variance estimations, please refer to David A. Cohn: "Neural Network Exploration Using Optimal
  Experimental Design."</p>
<dl class="user"><dt><b>Example</b></dt><dd><div class="fragment"><pre class="fragment">  <span class="comment">// Create own network class using Variance Estimator:</span>
  <span class="keyword">class </span>MyNet : <span class="keyword">public</span> <a class="code" href="class_f_f_net.html" title="Offers the functions to create and to work with a feed-forward network.">FFNet</a>,
                <span class="keyword">public</span> <a class="code" href="class_mean_squared_error.html" title="Calculates the mean squared error.">MeanSquaredError</a>,
                ...,
                <span class="keyword">public</span> <a class="code" href="class_variance_estimator.html" title="Offers the methods to deal with active learning of a neural network.">VarianceEstimator</a>

  {
      ...
  }

  <span class="keywordtype">void</span> main()
  {

      <span class="comment">// Create net:</span>
      MyNet net;

      <span class="comment">// Fill net:</span>
      ...

      <span class="comment">// Training the net:</span>
      <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> epoch = 1; epoch &lt; max_epochs; epoch++ )
      {
          <span class="comment">// Train net with prefered optimization algorithm:</span>
          ...

          <span class="comment">// Estimate current variance of the model:</span>
          currVar = net.overallVariance( inputTrain, targetTrain );

          <span class="comment">// Active learning step - choose one of the patterns</span>
          <span class="comment">// of the additional set, that will decrease the</span>
          <span class="comment">// variance most and add it to the training set:</span>
          <span class="comment">//</span>
          <span class="comment">// Calculates values &quot;invInfMat&quot;, &quot;transInvInfMat&quot; and &quot;s2&quot;,</span>
          <span class="comment">// that are necessary for the estimation</span>
          <span class="comment">// of the variance change:</span>
          net.estimateInvFisher( inputTrain, targetTrain,
                                 invInfMat, transInvInfMat, s2 );

          <span class="comment">// Estimate variance change of the model for all patterns</span>
          <span class="comment">// of the additional set:</span>
          <span class="keywordflow">for</span> ( <a class="code" href="_b_f_g_s_8cpp.html#ac23062089f3a5a2693cbb4ce7a75f1e5" title="Initializes some internal variables used by the BFGS algorithm, calculates the current error of the m...">i</a> = 0; <a class="code" href="_b_f_g_s_8cpp.html#ac23062089f3a5a2693cbb4ce7a75f1e5" title="Initializes some internal variables used by the BFGS algorithm, calculates the current error of the m...">i</a> &lt; no_additionals; <a class="code" href="_b_f_g_s_8cpp.html#ac23062089f3a5a2693cbb4ce7a75f1e5" title="Initializes some internal variables used by the BFGS algorithm, calculates the current error of the m...">i</a>++ )
          {
              varChange =
                  net.estimateVarianceChange( inputAdditional[ <a class="code" href="_b_f_g_s_8cpp.html#ac23062089f3a5a2693cbb4ce7a75f1e5" title="Initializes some internal variables used by the BFGS algorithm, calculates the current error of the m...">i</a> ],
                                              invInfMat,
                                              transInvInfMat, s2    );

              ...
          }

          <span class="comment">// Choose pattern which minimizes the model variance:</span>
          ...

          <span class="comment">// Monitor variance at the chosen reference point:</span>
          refVar = net.estimateVariance( inputAdditional[ bestIndex ],
                           invInfMat                     );

          <span class="comment">// Add chosen pattern to the training set:</span>
          ...

      } <span class="comment">// next training epoch</span>
  }
</pre></div></dd></dl>
<p>This example shows, how to use the variance estimation. <br/>
 In addition to your "normal" training set, you also use a set of additional patterns (predefined or random), that can be added one by one to the original training set. <br/>
 For each active learning step add one pattern to the training set and use the methods of class <a class="el" href="class_variance_estimator.html" title="Offers the methods to deal with active learning of a neural network.">VarianceEstimator</a> to choose the pattern, that will decrease the variance of the current model at most. <br/>
</p>
<dl class="author"><dt><b>Author:</b></dt><dd>M. Kreutz </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>2001-05-04</dd></dl>
<dl class="user"><dt><b>Changes:</b></dt><dd>none</dd></dl>
<dl class="user"><dt><b>Status:</b></dt><dd>stable </dd></dl>

<p>Definition at line <a class="el" href="_variance_estimator_8h_source.html#l00178">178</a> of file <a class="el" href="_variance_estimator_8h_source.html">VarianceEstimator.h</a>.</p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aea522ef604104c2ddab4d2616e30802e"></a><!-- doxytag: member="VarianceEstimator::estimateFisherInformation" ref="aea522ef604104c2ddab4d2616e30802e" args="(Model &amp;model, const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;outputA, Array&lt; double &gt; &amp;infMatA)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VarianceEstimator::estimateFisherInformation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_model.html">Model</a> &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>inputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>outputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>infMatA</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The Fisher information matrix is estimated. </p>
<p>Given a training set with input patterns <img class="formulaInl" alt="$x_i$" src="form_73.png"/> with the corresponding target values <img class="formulaInl" alt="$y_i \mbox{,\ } i = 1, \dots, m$" src="form_74.png"/> the current value of the used negative log likelihood measure of the weights (also called a score) is proportional to</p>
<p><img class="formulaInl" alt="$ S^2 = \frac{1}{m} \sum_{i = 1}^m (y_i - \hat{y}(x_i))^2 $" src="form_75.png"/></p>
<p>where <img class="formulaInl" alt="$\hat{y}$" src="form_76.png"/> is the output of the used network for the input <img class="formulaInl" alt="$x_i$" src="form_73.png"/>. After calculating the value of the measure, the Fisher information matrix can be estimated by</p>
<p><img class="formulaInl" alt="$ A = \frac{1}{S^2} \sum_{i = 1}^m \frac{\partial \hat{y}}{\partial w} \frac{\partial \hat{y}}{\partial w}^T $" src="form_77.png"/></p>
<p>where <img class="formulaInl" alt="$\hat{y} = f_{\hat{w}}(x)$" src="form_78.png"/> is the learners best guess for mapping inputs <img class="formulaInl" alt="$x$" src="form_79.png"/> to outputs <img class="formulaInl" alt="$y$" src="form_80.png"/> with <img class="formulaInl" alt="$\hat{w}$" src="form_81.png"/> as the weight vector of the network that minimizes the negative log likelihood measure <img class="formulaInl" alt="$S^2$" src="form_82.png"/>, i.e. <img class="formulaInl" alt="$\hat{y}$" src="form_76.png"/> is an estimate of the corresponding <img class="formulaInl" alt="$y$" src="form_80.png"/>.<br/>
 The Fisher information matrix measures the information contained in the training data set about each parameter (i.e. each weight).<br/>
 The inverse of the matrix then provides an approximation to the variance of the maximum-likelihood estimator which becomes increasingly accurate as the sample size increases.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">inputA</td><td>The input patterns <img class="formulaInl" alt="$x_i$" src="form_73.png"/> of the training set. </td></tr>
    <tr><td class="paramname">outputA</td><td>The target values <img class="formulaInl" alt="$y_i$" src="form_83.png"/> for the used input patterns. </td></tr>
    <tr><td class="paramname">infMatA</td><td>The calculated Fisher information matrix <img class="formulaInl" alt="$A$" src="form_84.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>none </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">check_exception</td><td>the type of the exception will be "size mismatch" and indicates that <em>inputA</em> is not 2-dimensional</td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>M. Kreutz </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>2001-05-04</dd></dl>
<dl class="user"><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl class="user"><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>Definition at line <a class="el" href="_variance_estimator_8cpp_source.html#l00124">124</a> of file <a class="el" href="_variance_estimator_8cpp_source.html">VarianceEstimator.cpp</a>.</p>

<p>References <a class="el" href="_b_f_g_s_8cpp_source.html#l00321">i</a>, and <a class="el" href="_model_8cpp_source.html#l00056">Model::modelDerivative()</a>.</p>

</div>
</div>
<a class="anchor" id="a5ad1079b076b10035dd4a04e0d8d2f4c"></a><!-- doxytag: member="VarianceEstimator::estimateInvFisher" ref="a5ad1079b076b10035dd4a04e0d8d2f4c" args="(Model &amp;model, const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;outputA, Array&lt; double &gt; &amp;invInfMatA, Array&lt; double &gt; &amp;transInvInfMatA, double &amp;s2A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VarianceEstimator::estimateInvFisher </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_model.html">Model</a> &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>inputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>outputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>invInfMatA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>transInvInfMatA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>s2A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Estimates the inverse Fisher information matrix and other values used for quantifying changes in variance due to active learning. </p>
<p>Given all input patterns <img class="formulaInl" alt="$x_i \mbox{,\ } i = 1, \dots, m$" src="form_85.png"/> of the training set and the corresponding target values <img class="formulaInl" alt="$y_i$" src="form_83.png"/> three values/matrices are calculated:</p>
<ul>
<li>
the inverse Fisher information matrix ( <img class="formulaInl" alt="$A^{-1}$" src="form_86.png"/>) </li>
<li>
the negative log likelihood measure <img class="formulaInl" alt="$S^2$" src="form_82.png"/>  </li>
<li>
<img class="formulaInl" alt="$A^{-1} \cdot {\langle \frac{\partial \hat{y}}{\partial w}\frac{\partial \hat{y}}{\partial w}^T \rangle}_X \cdot A^{-1}$" src="form_87.png"/>, where <img class="formulaInl" alt="${\langle \cdot \rangle}_X$" src="form_88.png"/> represents the expected value over <img class="formulaInl" alt="$X$" src="form_89.png"/>. </li>
</ul>
<p>For the definition of <img class="formulaInl" alt="$A$" src="form_84.png"/>, <img class="formulaInl" alt="$S^2$" src="form_82.png"/> and <img class="formulaInl" alt="$\hat{y}$" src="form_76.png"/> please refer to method <a class="el" href="class_variance_estimator.html#aea522ef604104c2ddab4d2616e30802e" title="The Fisher information matrix is estimated.">estimateFisherInformation</a>. <br/>
 The three evaluated values are used for the calculation of the expected change in the output variance (calculated by method <a class="el" href="class_variance_estimator.html#ac13748ca912f361a297d313f82560722" title="Estimates the change in the output variance after an active learning step.">estimateVarianceChange</a>), after a new example <img class="formulaInl" alt="$(\tilde{x}, \tilde{y})$" src="form_90.png"/> is added to the training set.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">inputA</td><td>The input patterns <img class="formulaInl" alt="$x_i$" src="form_73.png"/> of the training set, including the new input pattern <img class="formulaInl" alt="$\tilde{x}$" src="form_72.png"/>. </td></tr>
    <tr><td class="paramname">outputA</td><td>The target values <img class="formulaInl" alt="$y_i$" src="form_83.png"/> for the used input patterns. </td></tr>
    <tr><td class="paramname">invInfMatA</td><td>The calculated inverse Fisher information matrix <img class="formulaInl" alt="$A^{-1}$" src="form_86.png"/>. </td></tr>
    <tr><td class="paramname">transInvInfMatA</td><td>The third calculated value as listed above. </td></tr>
    <tr><td class="paramname">s2A</td><td>The current value of the negative log likelihood measure <img class="formulaInl" alt="$S^2$" src="form_82.png"/>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>none </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">check_exception</td><td>the type of the exception will be "size mismatch" and indicates that <em>inputA</em> is not 2-dimensional</td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>M. Kreutz </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>2001-05-04</dd></dl>
<dl class="user"><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl class="user"><dt><b>Status</b></dt><dd>stable</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="class_variance_estimator.html#a5ad1079b076b10035dd4a04e0d8d2f4c" title="Estimates the inverse Fisher information matrix and other values used for quantifying changes in vari...">estimateInvFisher</a> </dd></dl>

<p>Definition at line <a class="el" href="_variance_estimator_8cpp_source.html#l00211">211</a> of file <a class="el" href="_variance_estimator_8cpp_source.html">VarianceEstimator.cpp</a>.</p>

<p>References <a class="el" href="_b_f_g_s_8cpp_source.html#l00321">i</a>, and <a class="el" href="_model_8cpp_source.html#l00056">Model::modelDerivative()</a>.</p>

</div>
</div>
<a class="anchor" id="a30e99fc49668973fd09b5e76f534a175"></a><!-- doxytag: member="VarianceEstimator::estimateVariance" ref="a30e99fc49668973fd09b5e76f534a175" args="(Model &amp;model, const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;invInfMatA)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double VarianceEstimator::estimateVariance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_model.html">Model</a> &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>inputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>invInfMatA</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The estimated output variance of the network for one input pattern is returned. </p>
<p>Given one input pattern, the output variance <img class="formulaInl" alt="$\sigma^2_{\hat{y}|x_r}$" src="form_91.png"/> at this reference input <img class="formulaInl" alt="$x_r$" src="form_92.png"/> can be approximated by <img class="formulaInl" alt="$ \sigma^2_{\hat{y}|x_r} \approx \frac{\partial \hat{y}}{\partial w}^T A^{-1} \frac{\partial \hat{y}}{\partial w} $" src="form_95.png"/></p>
<p>where <img class="formulaInl" alt="$\hat{y} = f_{\hat{w}}(x)$" src="form_78.png"/> is the learners best guess for mapping inputs <img class="formulaInl" alt="$x$" src="form_79.png"/> to outputs <img class="formulaInl" alt="$y$" src="form_80.png"/> with <img class="formulaInl" alt="$\hat{w}$" src="form_81.png"/> as the weight vector of the network that minimizes the negative log likelihood measure <img class="formulaInl" alt="$S^2$" src="form_82.png"/> and <img class="formulaInl" alt="$A^{-1}$" src="form_86.png"/> is the inverse Fisher information matrix (see method <a class="el" href="class_variance_estimator.html#aea522ef604104c2ddab4d2616e30802e" title="The Fisher information matrix is estimated.">estimateFisherInformation</a> for details).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">inputA</td><td>The reference input pattern <img class="formulaInl" alt="$x_r$" src="form_92.png"/> of the training set. </td></tr>
    <tr><td class="paramname">invInfMatA</td><td>The calculated inverse Fisher information matrix <img class="formulaInl" alt="$A^{-1}$" src="form_86.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The estimated output variance <img class="formulaInl" alt="$\sigma^2_{\hat{y}|x_r}$" src="form_91.png"/>.</dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>M. Kreutz </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>2001-05-04</dd></dl>
<dl class="user"><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl class="user"><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>Definition at line <a class="el" href="_variance_estimator_8cpp_source.html#l00395">395</a> of file <a class="el" href="_variance_estimator_8cpp_source.html">VarianceEstimator.cpp</a>.</p>

<p>References <a class="el" href="_model_8cpp_source.html#l00056">Model::modelDerivative()</a>.</p>

</div>
</div>
<a class="anchor" id="ac13748ca912f361a297d313f82560722"></a><!-- doxytag: member="VarianceEstimator::estimateVarianceChange" ref="ac13748ca912f361a297d313f82560722" args="(Model &amp;model, const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;invInfMatA, const Array&lt; double &gt; &amp;transInvInfMatA, double s2A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double VarianceEstimator::estimateVarianceChange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_model.html">Model</a> &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>inputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>invInfMatA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>transInvInfMatA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s2A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Estimates the change in the output variance after an active learning step. </p>
<p>When active learning takes place, i.e. a chosen input <img class="formulaInl" alt="$\tilde{x}$" src="form_72.png"/> and its corresponding <img class="formulaInl" alt="$\tilde{y}$" src="form_96.png"/> are added to the training set, the variance of the model will change. Then the variance change has to be computed to select <img class="formulaInl" alt="$\tilde{x}$" src="form_72.png"/> optimally. <br/>
 The expected change in output variance can be estimated by </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\langle \Delta \sigma^2_{\hat{y}|\tilde{x}}\rangle}_{X,\tilde{Y}} = \frac{\frac{\partial \hat{y}}{\partial w}^T \cdot {\langle \frac{\partial \hat{y}}{\partial w}\frac{\partial \hat{y}}{\partial w}^T \rangle}_X \cdot A^{-1} \cdot \frac{\partial \hat{y}}{\partial w}}{S^2 + \frac{\partial \hat{y}}{\partial w}^T \cdot A^{-1} \cdot \frac{\partial \hat{y}}{\partial w}}, \]" src="form_97.png"/>
</p>
<p> where <img class="formulaInl" alt="${\langle \cdot \rangle}_{X, \tilde{Y}}$" src="form_98.png"/> represents the expected values over <img class="formulaInl" alt="$X$" src="form_89.png"/> and <img class="formulaInl" alt="$\tilde{Y}$" src="form_99.png"/>. <br/>
 For a definition of <img class="formulaInl" alt="$S^2$" src="form_82.png"/>, <img class="formulaInl" alt="$A$" src="form_84.png"/> and <img class="formulaInl" alt="$\hat{y}$" src="form_76.png"/> please refer to method <a class="el" href="class_variance_estimator.html#aea522ef604104c2ddab4d2616e30802e" title="The Fisher information matrix is estimated.">estimateFisherInformation</a>. <br/>
 The values used for the calculation of the variance change can be calculated by using method <a class="el" href="class_variance_estimator.html#a5ad1079b076b10035dd4a04e0d8d2f4c" title="Estimates the inverse Fisher information matrix and other values used for quantifying changes in vari...">estimateInvFisher</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">inputA</td><td>The new input pattern <img class="formulaInl" alt="$\tilde{x}$" src="form_72.png"/> that should be added to the training set. </td></tr>
    <tr><td class="paramname">invInfMatA</td><td>The inverse Fisher information matrix. </td></tr>
    <tr><td class="paramname">transInvInfMatA</td><td>A term that is used for the calculation of the variance change. For a definition of this term please refer to method <a class="el" href="class_variance_estimator.html#a5ad1079b076b10035dd4a04e0d8d2f4c" title="Estimates the inverse Fisher information matrix and other values used for quantifying changes in vari...">estimateInvFisher</a>. </td></tr>
    <tr><td class="paramname">s2A</td><td>The current value of the negative log likelihood measure <img class="formulaInl" alt="$S^2$" src="form_82.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>M. Kreutz </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>2001-05-04</dd></dl>
<dl class="user"><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl class="user"><dt><b>Status</b></dt><dd>stable</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="class_variance_estimator.html#a5ad1079b076b10035dd4a04e0d8d2f4c" title="Estimates the inverse Fisher information matrix and other values used for quantifying changes in vari...">estimateInvFisher</a> </dd></dl>

<p>Definition at line <a class="el" href="_variance_estimator_8cpp_source.html#l00451">451</a> of file <a class="el" href="_variance_estimator_8cpp_source.html">VarianceEstimator.cpp</a>.</p>

<p>References <a class="el" href="_model_8cpp_source.html#l00056">Model::modelDerivative()</a>.</p>

</div>
</div>
<a class="anchor" id="a9b522838819bbfd5c32d122777ca7613"></a><!-- doxytag: member="VarianceEstimator::overallVariance" ref="a9b522838819bbfd5c32d122777ca7613" args="(Model &amp;model, const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;outputA)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double VarianceEstimator::overallVariance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_model.html">Model</a> &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>inputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>outputA</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The estimated output variance of the network for all input patterns is returned. </p>
<p>The average variance over all input patterns <img class="formulaInl" alt="$x_i \mbox{,\ } i = 1, \dots, m$" src="form_85.png"/> is calculated by a stochastic estimate based on an average of <img class="formulaInl" alt="$\sigma^2_{\hat{y}|x_r}$" src="form_91.png"/> with a reference point <img class="formulaInl" alt="$x_r$" src="form_92.png"/> drawn according to the known input distribution (for a calculation of <img class="formulaInl" alt="$\sigma^2_{\hat{y}|x_r}$" src="form_91.png"/> for a single reference point <img class="formulaInl" alt="$x_r$" src="form_92.png"/> please refer to method <a class="el" href="class_variance_estimator.html#a30e99fc49668973fd09b5e76f534a175" title="The estimated output variance of the network for one input pattern is returned.">estimateVariance</a>). <br/>
 The overall variance is then estimated by</p>
<p><img class="formulaInl" alt="$ {\langle \sigma^2_{\hat{y}} \rangle}_X = {\langle \frac{\partial \hat{y}}{\partial w}\rangle}_X^T A^{-1} {\langle \frac{\partial \hat{y}}{\partial w}\rangle}_X + \mbox{trace}(A^{-1} {\langle \frac{\partial \hat{y}}{\partial w} \rangle}_X^T {\langle \frac{\partial \hat{y}}{\partial w}\rangle}_X) $" src="form_93.png"/></p>
<p>where <img class="formulaInl" alt="$\hat{y} = f_{\hat{w}}(x)$" src="form_78.png"/> is the learners best guess for mapping inputs <img class="formulaInl" alt="$x$" src="form_79.png"/> to outputs <img class="formulaInl" alt="$y$" src="form_80.png"/> with <img class="formulaInl" alt="$\hat{w}$" src="form_81.png"/> as the weight vector of the network that minimizes the negative log likelihood measure <img class="formulaInl" alt="$S^2$" src="form_82.png"/>, <img class="formulaInl" alt="$A^{-1}$" src="form_86.png"/> is the inverse Fisher information matrix (see method <a class="el" href="class_variance_estimator.html#aea522ef604104c2ddab4d2616e30802e" title="The Fisher information matrix is estimated.">estimateFisherInformation</a> for details) and <img class="formulaInl" alt="${\langle \cdot \rangle}_X$" src="form_88.png"/> represents the expected value over <img class="formulaInl" alt="$X$" src="form_89.png"/>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">inputA</td><td>The input patterns <img class="formulaInl" alt="$x_i$" src="form_73.png"/> of the training set. </td></tr>
    <tr><td class="paramname">outputA</td><td>The corresponding target values <img class="formulaInl" alt="$y_i$" src="form_83.png"/> of the input patterns. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The estimated output variance <img class="formulaInl" alt="${\langle \sigma^2_{\hat{y}} \rangle}_X$" src="form_94.png"/>. </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">check_exception</td><td>the type of the exception will be "size mismatch" and indicates that <em>inputA</em> is not 2-dimensional</td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>M. Kreutz </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>2001-05-04</dd></dl>
<dl class="user"><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl class="user"><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>Definition at line <a class="el" href="_variance_estimator_8cpp_source.html#l00315">315</a> of file <a class="el" href="_variance_estimator_8cpp_source.html">VarianceEstimator.cpp</a>.</p>

<p>References <a class="el" href="_b_f_g_s_8cpp_source.html#l00321">i</a>, and <a class="el" href="_model_8cpp_source.html#l00056">Model::modelDerivative()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_variance_estimator_8h_source.html">VarianceEstimator.h</a></li>
<li><a class="el" href="_variance_estimator_8cpp_source.html">VarianceEstimator.cpp</a></li>
</ul>
</div>
</div>
</div>
</body></html>
