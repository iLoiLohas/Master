<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ReClaM: BFGS.h Source File</title>
<script type="text/javaScript" src="search/search.js"></script>
<link href="../css/main.css" rel="stylesheet" type="text/css"/>
</head>
<body id="type-b">

<div id="wrap">
<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
<div id="poweredby">
<img style="width: 95%;" src="../images/SharkLogo.png"/>
</div>		
  
<ul id="nav">
  <li class="first"><a href="../index.html">About Shark</a></li>
  <li><a href="#">Sourceforge</a>
  
  <ul>
    <li class="first"><a href="http://shark-project.sourceforge.net">Project Summary</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/files/">Downloads</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/develop">Subversion Repository</a></li>
  </ul>
  
</li>
<li class="first"><a href="../GettingStarted.html">Getting Started</a>
<li class="first"><a href="../Tutorials.html">Tutorials</a>
<li class="first"><a href="../FAQ.html">FAQ</a>

<li class="first"><a href="#">Main Modules</a>
<ul>
  <li class="first"><a href="../ReClaM/index.html">ReClaM</a>
  <li class="first"><a href="../EALib/index.html">EALib</a>
  <li class="first"><a href="../MOO-EALib/index.html">MOO-EALib</a>
  <li class="first"><a href="../Fuzzy/index.html">Fuzzy</a>
</ul>
</li>
<li class="first"><a href="#">Tools</a>
<ul>
  <li class="first"><a href="../Mixture/index.html">Mixture</a>
  <li><a href="../Array/index.html">Array</a>
  <li><a href="../Rng/index.html">Rng</a>
  <li><a href="../LinAlg/index.html">LinAlg</a>
  <li class="last"><a href="../FileUtil/index.html">FileUtil</a>		    
</ul>
</li>
</ul>
</div>

<!--<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
  <ul id="nav">
    <li><a href="../index.html"><span>Shark&nbsp;Main&nbsp;Page</span></a></li>
    <li><a href="../Array/index.html"><span>Array</span></a></li>
    <li><a href="../Rng/index.html"><span>Rng</span></a></li>
    <li><a href="../LinAlg/index.html"><span>LinAlg</span></a></li>
    <li><a href="../FileUtil/index.html"><span>FileUtil</span></a></li>
    <li><a href="../EALib/index.html"><span>EALib</span></a></li>
    <li><a href="../MOO-EALib/index.html"><span>MOO-EALib</span></a></li>
    <li class="active"><a href="../ReClaM/index.html"><span>ReClaM</span></a></li>
    <li><a href="../Fuzzy/index.html"><span>Fuzzy</span></a></li>
    <li><a href="../Mixture/index.html"><span>Mixture</span></a></li>
    <li><a href="../tutorials/index.html"><span>Tutorials</span></a></li>
    <li><a href="../faq/index.html"><span>FAQ</span></a></li>
  </ul>
 </div> -->
<!-- Generated by Doxygen 1.7.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>BFGS.h</h1>  </div>
</div>
<div class="contents">
<a href="_b_f_g_s_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//===========================================================================</span>
<a name="l00069"></a>00069 <span class="comment"></span><span class="comment">//===========================================================================</span>
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 <span class="preprocessor">#ifndef BFGS_H</span>
<a name="l00073"></a>00073 <span class="preprocessor"></span><span class="preprocessor">#define BFGS_H</span>
<a name="l00074"></a>00074 <span class="preprocessor"></span>
<a name="l00075"></a>00075 <span class="preprocessor">#include &quot;ReClaM/Optimizer.h&quot;</span>
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="comment">//===========================================================================</span>
<a name="l00127"></a><a class="code" href="class_b_f_g_s.html">00127</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="class_b_f_g_s.html" title="Offers methods to use the Broyden-Fletcher-Goldfarb-Shanno algorithm for the optimization of models...">BFGS</a> : <span class="keyword">public</span> <a class="code" href="class_optimizer.html" title="Base class of all optimizers.">Optimizer</a>
<a name="l00128"></a>00128 {
<a name="l00129"></a>00129 <span class="keyword">public</span>:
<a name="l00130"></a>00130 
<a name="l00137"></a><a class="code" href="class_b_f_g_s.html#ae5f143fc417c982f31c96b89bd767676af06a0f8ee43a21249befce1e88984b91">00137</a>     <span class="keyword">enum</span> <a class="code" href="class_b_f_g_s.html#ae5f143fc417c982f31c96b89bd767676" title="Used to specify the type of line search algorithm that is used by the BFGS algorithm:   &amp;quot;Linmin&amp;...">LineSearch</a> { <a class="code" href="class_b_f_g_s.html#ae5f143fc417c982f31c96b89bd767676a6c4db6f5633b0c3aa7787f613818892f">Dlinmin</a>, <a class="code" href="class_b_f_g_s.html#ae5f143fc417c982f31c96b89bd767676af06a0f8ee43a21249befce1e88984b91">Linmin</a>, <a class="code" href="class_b_f_g_s.html#ae5f143fc417c982f31c96b89bd767676a0f22d78bfcbdb289c850746ef48b3f37">Cblnsrch</a> };
<a name="l00138"></a>00138 
<a name="l00141"></a>00141 
<a name="l00142"></a>00142     <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#a59973f1f2733d5d1b495e93a221010b1" title="Updates the weights of the network by using the BFGS optimization algorithm.">bfgs</a>(<a class="code" href="class_model.html" title="Base class of all models.">Model</a>&amp; model,
<a name="l00143"></a>00143               <a class="code" href="class_error_function.html" title="Base class of all error measures.">ErrorFunction</a>&amp; error,
<a name="l00144"></a>00144               <span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="_b_f_g_s_8cpp.html#ac23062089f3a5a2693cbb4ce7a75f1e5" title="Initializes some internal variables used by the BFGS algorithm, calculates the current error of the m...">i</a>,
<a name="l00145"></a>00145               <span class="keyword">const</span> Array&lt;double&gt; &amp;t,
<a name="l00146"></a>00146               <span class="keywordtype">double</span>    gtol,
<a name="l00147"></a>00147               <span class="keywordtype">unsigned</span>&amp; iter,
<a name="l00148"></a>00148               <span class="keywordtype">double</span>&amp;   fret,
<a name="l00149"></a>00149               <span class="keywordtype">unsigned</span>  iterMax);
<a name="l00150"></a>00150 <span class="comment">//===========================================================================</span>
<a name="l00182"></a>00182 <span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#a76750e480009bfd820e64b3e86267df1" title="Initializes some internal variables used by the BFGS algorithm.">init</a>(<a class="code" href="class_model.html" title="Base class of all models.">Model</a>&amp; model);
<a name="l00183"></a>00183 
<a name="l00184"></a>00184     <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#a9e1316915113ab0428cab8dea9fe5315">initBfgs</a>(<a class="code" href="class_model.html" title="Base class of all models.">Model</a>&amp; model, <a class="code" href="class_b_f_g_s.html#ae5f143fc417c982f31c96b89bd767676" title="Used to specify the type of line search algorithm that is used by the BFGS algorithm:   &amp;quot;Linmin&amp;...">LineSearch</a> ls = <a class="code" href="class_b_f_g_s.html#ae5f143fc417c982f31c96b89bd767676a6c4db6f5633b0c3aa7787f613818892f">Dlinmin</a>,
<a name="l00185"></a>00185                   <span class="keywordtype">double</span> ax = 0., <span class="keywordtype">double</span> bx = 1., <span class="keywordtype">double</span> lambda = 0.25);
<a name="l00186"></a>00186 
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 <span class="comment">//===========================================================================</span>
<a name="l00219"></a>00219 <span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="class_b_f_g_s.html#a3bb995e40a0dda7ae76d9ecf962209b9" title="Updates the weights of the network by using the BFGS optimization algorithm, that was previously init...">optimize</a>(
<a name="l00220"></a>00220         <a class="code" href="class_model.html" title="Base class of all models.">Model</a>&amp; model,
<a name="l00221"></a>00221         <a class="code" href="class_error_function.html" title="Base class of all error measures.">ErrorFunction</a>&amp; errorfunction,
<a name="l00222"></a>00222         <span class="keyword">const</span> Array&lt;double&gt;&amp; input,
<a name="l00223"></a>00223         <span class="keyword">const</span> Array&lt;double&gt;&amp; target);
<a name="l00224"></a>00224     <span class="keywordtype">double</span> <a class="code" href="class_b_f_g_s.html#a3bb995e40a0dda7ae76d9ecf962209b9" title="Updates the weights of the network by using the BFGS optimization algorithm, that was previously init...">optimize</a>(
<a name="l00225"></a>00225         <a class="code" href="class_model.html" title="Base class of all models.">Model</a>&amp; model,
<a name="l00226"></a>00226         <a class="code" href="class_error_function.html" title="Base class of all error measures.">ErrorFunction</a>&amp; errorfunction,
<a name="l00227"></a>00227         <span class="keyword">const</span> Array&lt;double&gt;&amp; input,
<a name="l00228"></a>00228         <span class="keyword">const</span> Array&lt;double&gt;&amp; target,
<a name="l00229"></a>00229         <span class="keywordtype">double</span> gtol,
<a name="l00230"></a>00230         <span class="keywordtype">int</span> iterMax);
<a name="l00231"></a>00231 
<a name="l00232"></a>00232     <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#a59973f1f2733d5d1b495e93a221010b1" title="Updates the weights of the network by using the BFGS optimization algorithm.">bfgs</a>(<a class="code" href="class_model.html" title="Base class of all models.">Model</a>&amp; model,
<a name="l00233"></a>00233               <a class="code" href="class_error_function.html" title="Base class of all error measures.">ErrorFunction</a>&amp; errorfunction,
<a name="l00234"></a>00234               <span class="keyword">const</span> Array&lt;double&gt; &amp;in,
<a name="l00235"></a>00235               <span class="keyword">const</span> Array&lt;double&gt; &amp;target,
<a name="l00236"></a>00236               <span class="keywordtype">double</span>&amp; fret);
<a name="l00237"></a>00237 
<a name="l00238"></a><a class="code" href="class_b_f_g_s.html#ad860a47a84a2d2ab2d3b299ac3816312">00238</a>     <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#a59973f1f2733d5d1b495e93a221010b1" title="Updates the weights of the network by using the BFGS optimization algorithm.">bfgs</a>(<a class="code" href="class_model.html" title="Base class of all models.">Model</a>&amp; model,
<a name="l00239"></a>00239               <a class="code" href="class_error_function.html" title="Base class of all error measures.">ErrorFunction</a>&amp; errorfunction,
<a name="l00240"></a>00240               <span class="keyword">const</span> Array&lt;double&gt; &amp;in,
<a name="l00241"></a>00241               <span class="keyword">const</span> Array&lt;double&gt; &amp;target)
<a name="l00242"></a>00242     {
<a name="l00243"></a>00243         <span class="keywordtype">double</span> fret;
<a name="l00244"></a>00244         <a class="code" href="class_b_f_g_s.html#a59973f1f2733d5d1b495e93a221010b1" title="Updates the weights of the network by using the BFGS optimization algorithm.">bfgs</a>(model, errorfunction, in, target, fret);
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246 <span class="comment">//===========================================================================</span>
<a name="l00277"></a><a class="code" href="class_b_f_g_s.html#a8868635bdf1803958af7efcc6828d7d2">00277</a> <span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#a8868635bdf1803958af7efcc6828d7d2" title="Sets the initial value for the left bracket used by the line search algorithms.">setAx</a>(<span class="keywordtype">double</span> x)
<a name="l00278"></a>00278     {
<a name="l00279"></a>00279         LS_ax = x;
<a name="l00280"></a>00280     }
<a name="l00281"></a>00281 
<a name="l00282"></a>00282 <span class="comment">//===========================================================================</span>
<a name="l00313"></a><a class="code" href="class_b_f_g_s.html#a58cacff3b6038f8cd629bdd870f8a48e">00313</a> <span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#a58cacff3b6038f8cd629bdd870f8a48e" title="Sets the initial value for the right bracket used by the line search algorithms.">setBx</a>(<span class="keywordtype">double</span> x)
<a name="l00314"></a>00314     {
<a name="l00315"></a>00315         LS_bx = x;
<a name="l00316"></a>00316     }
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 
<a name="l00319"></a>00319 <span class="comment">//===========================================================================</span>
<a name="l00349"></a><a class="code" href="class_b_f_g_s.html#a41f286789d01d79cbc1ac68d56deea10">00349</a> <span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#a41f286789d01d79cbc1ac68d56deea10" title="Sets the initial value for  value used by the line search algorithms.">setLambda</a>(<span class="keywordtype">double</span> x)
<a name="l00350"></a>00350     {
<a name="l00351"></a>00351         LS_lambda = x;
<a name="l00352"></a>00352     }
<a name="l00353"></a>00353 
<a name="l00354"></a>00354     <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#a619e51247b0cda5a511026a309f0bce6">reset</a>();
<a name="l00355"></a>00355 <span class="keyword">private</span>:
<a name="l00356"></a>00356 <span class="comment">//  baustelle</span>
<a name="l00357"></a>00357 
<a name="l00358"></a>00358     <span class="keywordtype">void</span> dlinmin(<a class="code" href="class_model.html" title="Base class of all models.">Model</a>&amp; model,
<a name="l00359"></a>00359 
<a name="l00360"></a>00360                  <a class="code" href="class_error_function.html" title="Base class of all error measures.">ErrorFunction</a>&amp; errorfunction,
<a name="l00361"></a>00361 
<a name="l00362"></a>00362                  Array&lt;double&gt;&amp; dedw,
<a name="l00363"></a>00363 
<a name="l00364"></a>00364                  Array&lt; double &gt;&amp; p,
<a name="l00365"></a>00365 
<a name="l00366"></a>00366                  <span class="keyword">const</span> Array&lt; double &gt;&amp; xi,
<a name="l00367"></a>00367 
<a name="l00368"></a>00368                  <span class="keywordtype">double</span>&amp;                fret,
<a name="l00369"></a>00369 
<a name="l00370"></a>00370                  <span class="keyword">const</span> Array&lt; double &gt;&amp; in,
<a name="l00371"></a>00371 
<a name="l00372"></a>00372                  <span class="keyword">const</span> Array&lt; double &gt;&amp; target);
<a name="l00373"></a>00373 
<a name="l00374"></a>00374     <span class="keywordtype">void</span> linmin(<a class="code" href="class_model.html" title="Base class of all models.">Model</a>&amp; model,
<a name="l00375"></a>00375 
<a name="l00376"></a>00376                 <a class="code" href="class_error_function.html" title="Base class of all error measures.">ErrorFunction</a>&amp; errorfunction,
<a name="l00377"></a>00377 
<a name="l00378"></a>00378                 Array&lt;double&gt;&amp; dedw,
<a name="l00379"></a>00379 
<a name="l00380"></a>00380                 Array&lt; double &gt;&amp; p,
<a name="l00381"></a>00381 
<a name="l00382"></a>00382                 <span class="keyword">const</span> Array&lt; double &gt;&amp; xi,
<a name="l00383"></a>00383 
<a name="l00384"></a>00384                 <span class="keywordtype">double</span>&amp;                fret,
<a name="l00385"></a>00385 
<a name="l00386"></a>00386                 <span class="keyword">const</span> Array&lt; double &gt;&amp; in,
<a name="l00387"></a>00387 
<a name="l00388"></a>00388                 <span class="keyword">const</span> Array&lt; double &gt;&amp; target);
<a name="l00389"></a>00389 
<a name="l00390"></a>00390     <span class="keywordtype">void</span> cblnsrch(<a class="code" href="class_model.html" title="Base class of all models.">Model</a>&amp; model,
<a name="l00391"></a>00391 
<a name="l00392"></a>00392                   <a class="code" href="class_error_function.html" title="Base class of all error measures.">ErrorFunction</a>&amp; errorfunction,
<a name="l00393"></a>00393 
<a name="l00394"></a>00394                   <span class="keywordtype">double</span> fold,           <span class="comment">// evaluation at current solution</span>
<a name="l00395"></a>00395 
<a name="l00396"></a>00396                   Array&lt; double &gt;&amp; g,    <span class="comment">// current gradient</span>
<a name="l00397"></a>00397 
<a name="l00398"></a>00398                   Array&lt; double &gt;&amp; p,    <span class="comment">// search direction</span>
<a name="l00399"></a>00399 
<a name="l00400"></a>00400                   <span class="keywordtype">double</span>&amp; fret,
<a name="l00401"></a>00401 
<a name="l00402"></a>00402                   <span class="keyword">const</span> Array&lt; double &gt;&amp;in,
<a name="l00403"></a>00403 
<a name="l00404"></a>00404                   <span class="keyword">const</span> Array&lt; double &gt;&amp;target);
<a name="l00405"></a>00405 
<a name="l00406"></a>00406     <a class="code" href="class_b_f_g_s.html#ae5f143fc417c982f31c96b89bd767676" title="Used to specify the type of line search algorithm that is used by the BFGS algorithm:   &amp;quot;Linmin&amp;...">LineSearch</a>    lineSearchType;
<a name="l00407"></a>00407 
<a name="l00408"></a>00408     <span class="keywordtype">bool</span>         firstIteration;
<a name="l00409"></a>00409 
<a name="l00410"></a>00410     <span class="keywordtype">double</span>   FRET;
<a name="l00411"></a>00411 
<a name="l00412"></a>00412     <span class="keywordtype">double</span>        LS_lambda;
<a name="l00413"></a>00413 
<a name="l00414"></a>00414     <span class="keywordtype">double</span>        LS_ax;
<a name="l00415"></a>00415 
<a name="l00416"></a>00416     <span class="keywordtype">double</span>        LS_bx;
<a name="l00417"></a>00417 
<a name="l00418"></a>00418     <span class="keywordtype">unsigned</span>      BFGS_n;
<a name="l00419"></a>00419 
<a name="l00420"></a>00420     <span class="keywordtype">double</span>        BFGS_d;
<a name="l00421"></a>00421 
<a name="l00422"></a>00422     <span class="keywordtype">double</span>        BFGS_scale;
<a name="l00423"></a>00423 
<a name="l00424"></a>00424     Array&lt;double&gt; BFGS_s;
<a name="l00425"></a>00425 
<a name="l00426"></a>00426     Array&lt;double&gt; DEDW;
<a name="l00427"></a>00427 
<a name="l00428"></a>00428     Array&lt;double&gt; BFGS_g0;
<a name="l00429"></a>00429 
<a name="l00430"></a>00430     Array&lt;double&gt; BFGS_g1;
<a name="l00431"></a>00431 
<a name="l00432"></a>00432     Array&lt;double&gt; BFGS_p1;
<a name="l00433"></a>00433 
<a name="l00434"></a>00434     Array&lt;double&gt; BFGS_gamma;
<a name="l00435"></a>00435 
<a name="l00436"></a>00436     Array&lt;double&gt; BFGS_delta;
<a name="l00437"></a>00437 
<a name="l00438"></a>00438     Array&lt;double&gt; BFGS_p;
<a name="l00439"></a>00439 
<a name="l00440"></a>00440     <span class="comment">// the approximated Hessian matrix</span>
<a name="l00441"></a>00441     Array&lt;double&gt; H;
<a name="l00442"></a>00442 
<a name="l00443"></a>00443 };
<a name="l00444"></a>00444 
<a name="l00445"></a>00445 <span class="preprocessor">#endif</span>
<a name="l00446"></a>00446 <span class="preprocessor"></span>
</pre></div></div>
</div>
</div>
</div>
</body></html>
