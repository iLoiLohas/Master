<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ReClaM: StochasticGradientDescent Class Reference</title>
<script type="text/javaScript" src="search/search.js"></script>
<link href="../css/main.css" rel="stylesheet" type="text/css"/>
</head>
<body id="type-b">

<div id="wrap">
<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
<div id="poweredby">
<img style="width: 95%;" src="../images/SharkLogo.png"/>
</div>		
  
<ul id="nav">
  <li class="first"><a href="../index.html">About Shark</a></li>
  <li><a href="#">Sourceforge</a>
  
  <ul>
    <li class="first"><a href="http://shark-project.sourceforge.net">Project Summary</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/files/">Downloads</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/develop">Subversion Repository</a></li>
  </ul>
  
</li>
<li class="first"><a href="../GettingStarted.html">Getting Started</a>
<li class="first"><a href="../Tutorials.html">Tutorials</a>
<li class="first"><a href="../FAQ.html">FAQ</a>

<li class="first"><a href="#">Main Modules</a>
<ul>
  <li class="first"><a href="../ReClaM/index.html">ReClaM</a>
  <li class="first"><a href="../EALib/index.html">EALib</a>
  <li class="first"><a href="../MOO-EALib/index.html">MOO-EALib</a>
  <li class="first"><a href="../Fuzzy/index.html">Fuzzy</a>
</ul>
</li>
<li class="first"><a href="#">Tools</a>
<ul>
  <li class="first"><a href="../Mixture/index.html">Mixture</a>
  <li><a href="../Array/index.html">Array</a>
  <li><a href="../Rng/index.html">Rng</a>
  <li><a href="../LinAlg/index.html">LinAlg</a>
  <li class="last"><a href="../FileUtil/index.html">FileUtil</a>		    
</ul>
</li>
</ul>
</div>

<!--<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
  <ul id="nav">
    <li><a href="../index.html"><span>Shark&nbsp;Main&nbsp;Page</span></a></li>
    <li><a href="../Array/index.html"><span>Array</span></a></li>
    <li><a href="../Rng/index.html"><span>Rng</span></a></li>
    <li><a href="../LinAlg/index.html"><span>LinAlg</span></a></li>
    <li><a href="../FileUtil/index.html"><span>FileUtil</span></a></li>
    <li><a href="../EALib/index.html"><span>EALib</span></a></li>
    <li><a href="../MOO-EALib/index.html"><span>MOO-EALib</span></a></li>
    <li class="active"><a href="../ReClaM/index.html"><span>ReClaM</span></a></li>
    <li><a href="../Fuzzy/index.html"><span>Fuzzy</span></a></li>
    <li><a href="../Mixture/index.html"><span>Mixture</span></a></li>
    <li><a href="../tutorials/index.html"><span>Tutorials</span></a></li>
    <li><a href="../faq/index.html"><span>FAQ</span></a></li>
  </ul>
 </div> -->
<!-- Generated by Doxygen 1.7.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<h1>StochasticGradientDescent Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="StochasticGradientDescent" --><!-- doxytag: inherits="Optimizer" -->
<p>Learning strategies based on <a class="el" href="class_steepest_descent.html" title="Standard steepest descent.">SteepestDescent</a>, but with randomly chosen patterns.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_stochastic_gradient_descent_8h_source.html">StochasticGradientDescent.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for StochasticGradientDescent:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_stochastic_gradient_descent.png" usemap="#StochasticGradientDescent_map" alt=""/>
  <map id="StochasticGradientDescent_map" name="StochasticGradientDescent_map">
<area href="class_optimizer.html" alt="Optimizer" shape="rect" coords="0,0,164,24"/>
</map>
 </div></div>

<p><a href="class_stochastic_gradient_descent-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stochastic_gradient_descent.html#a13e129e4be0f86f7555c3e1834476826">init</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stochastic_gradient_descent.html#a11a468d8ea868a315c94862e1cb2798b">initStochasticGradientDescent</a> (double lr=0.1, double mu=0.3, bool fast=false)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stochastic_gradient_descent.html#a7fe087a287f56edf068ece288b5ae60d">optimize</a> (<a class="el" href="class_model.html">Model</a> &amp;model, <a class="el" href="class_error_function.html">ErrorFunction</a> &amp;error, const Array&lt; double &gt; &amp;input, const Array&lt; double &gt; &amp;target)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Iterative update of weights, patterns are randomly chosen, each pattern only once.  <a href="#a7fe087a287f56edf068ece288b5ae60d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stochastic_gradient_descent.html#af12c4f9025470a46080923948ae36cfd">clearMemory</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the array of momentum values.  <a href="#af12c4f9025470a46080923948ae36cfd"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Learning strategies based on <a class="el" href="class_steepest_descent.html" title="Standard steepest descent.">SteepestDescent</a>, but with randomly chosen patterns. </p>
<p>Similar to the most simple learning strategy <a class="el" href="class_steepest_descent.html" title="Standard steepest descent.">SteepestDescent</a>, the weights of the network are iteratively updated to minimize the error. When working with more than one pattern and gradient descent, all patterns are sequentially presented to the network and the weight update takes place after every pattern. Here you will find two methods that work on the base of <a class="el" href="class_steepest_descent.html" title="Standard steepest descent.">SteepestDescent</a>, but that will chose the next pattern for presentation by random.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>P. Stagge </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl class="user"><dt><b>Changes:</b></dt><dd>none</dd></dl>
<dl class="user"><dt><b>Status:</b></dt><dd>stable </dd></dl>

<p>Definition at line <a class="el" href="_stochastic_gradient_descent_8h_source.html#l00086">86</a> of file <a class="el" href="_stochastic_gradient_descent_8h_source.html">StochasticGradientDescent.h</a>.</p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="af12c4f9025470a46080923948ae36cfd"></a><!-- doxytag: member="StochasticGradientDescent::clearMemory" ref="af12c4f9025470a46080923948ae36cfd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StochasticGradientDescent::clearMemory </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Clears the array of momentum values. </p>
<p>The momentum values are the values that are added to the weights for updating.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>P. Stagge </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl class="user"><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl class="user"><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>Definition at line <a class="el" href="_stochastic_gradient_descent_8h_source.html#l00228">228</a> of file <a class="el" href="_stochastic_gradient_descent_8h_source.html">StochasticGradientDescent.h</a>.</p>

</div>
</div>
<a class="anchor" id="a13e129e4be0f86f7555c3e1834476826"></a><!-- doxytag: member="StochasticGradientDescent::init" ref="a13e129e4be0f86f7555c3e1834476826" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StochasticGradientDescent::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_stochastic_gradient_descent_8h_source.html#l00089">89</a> of file <a class="el" href="_stochastic_gradient_descent_8h_source.html">StochasticGradientDescent.h</a>.</p>

<p>References <a class="el" href="_stochastic_gradient_descent_8h_source.html#l00094">initStochasticGradientDescent()</a>.</p>

</div>
</div>
<a class="anchor" id="a11a468d8ea868a315c94862e1cb2798b"></a><!-- doxytag: member="StochasticGradientDescent::initStochasticGradientDescent" ref="a11a468d8ea868a315c94862e1cb2798b" args="(double lr=0.1, double mu=0.3, bool fast=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StochasticGradientDescent::initStochasticGradientDescent </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lr</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mu</em> = <code>0.3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fast</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_stochastic_gradient_descent_8h_source.html#l00094">94</a> of file <a class="el" href="_stochastic_gradient_descent_8h_source.html">StochasticGradientDescent.h</a>.</p>

<p>Referenced by <a class="el" href="_stochastic_gradient_descent_8h_source.html#l00089">init()</a>.</p>

</div>
</div>
<a class="anchor" id="a7fe087a287f56edf068ece288b5ae60d"></a><!-- doxytag: member="StochasticGradientDescent::optimize" ref="a7fe087a287f56edf068ece288b5ae60d" args="(Model &amp;model, ErrorFunction &amp;error, const Array&lt; double &gt; &amp;input, const Array&lt; double &gt; &amp;target)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double StochasticGradientDescent::optimize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_model.html">Model</a> &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_error_function.html">ErrorFunction</a> &amp;&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Iterative update of weights, patterns are randomly chosen, each pattern only once. </p>
<p>Similar to <a class="el" href="class_steepest_descent.html" title="Standard steepest descent.">SteepestDescent</a>, where the weights are iteratively updated by moving a short distance in the direction of the greatest decrease of the error, i.e. in the direction of the negative gradient by using the error derivatives. Additionally a momentum term is added to the gradient descent to deal with the problem of widely differing eigenvalues. The update of a weight at time <img class="formulaInl" alt="$t$" src="form_104.png"/> to a weight at time <img class="formulaInl" alt="$t+1$" src="form_382.png"/> is then given as</p>
<p><img class="formulaInl" alt="$ \omega_{t+1} = \omega_t + \eta \nabla f(\omega_t) + \mu \Delta w_t $" src="form_383.png"/></p>
<p>In contrast to <a class="el" href="class_steepest_descent.html" title="Standard steepest descent.">SteepestDescent</a> the weights for more than one pattern are not updated by choosing the patterns sequentially, but randomly. Compared to #learnfast a pattern can not be chosen more than once.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>Input vector for the model. </td></tr>
    <tr><td class="paramname">target</td><td>Target vector. </td></tr>
    <tr><td class="paramname">lr</td><td>Learning rate <img class="formulaInl" alt="$ \eta $" src="form_106.png"/>. </td></tr>
    <tr><td class="paramname">mu</td><td>Momentum parameter <img class="formulaInl" alt="$ \mu $" src="form_381.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>P. Stagge </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl class="user"><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl class="user"><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>Implements <a class="el" href="class_optimizer.html#a6a8170818afe45a5516c4a4fea053f0f">Optimizer</a>.</p>

<p>Definition at line <a class="el" href="_stochastic_gradient_descent_8h_source.html#l00141">141</a> of file <a class="el" href="_stochastic_gradient_descent_8h_source.html">StochasticGradientDescent.h</a>.</p>

<p>References <a class="el" href="_error_function_8cpp_source.html#l00080">ErrorFunction::errorDerivative()</a>, and <a class="el" href="_b_f_g_s_8cpp_source.html#l00321">i</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="_stochastic_gradient_descent_8h_source.html">StochasticGradientDescent.h</a></li>
</ul>
</div>
</div>
</div>
</body></html>
