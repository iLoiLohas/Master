<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ReClaM: KernelOptimization.cpp</title>
<script type="text/javaScript" src="search/search.js"></script>
<link href="../css/main.css" rel="stylesheet" type="text/css"/>
</head>
<body id="type-b">

<div id="wrap">
<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
<div id="poweredby">
<img style="width: 95%;" src="../images/SharkLogo.png"/>
</div>		
  
<ul id="nav">
  <li class="first"><a href="../index.html">About Shark</a></li>
  <li><a href="#">Sourceforge</a>
  
  <ul>
    <li class="first"><a href="http://shark-project.sourceforge.net">Project Summary</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/files/">Downloads</a></li>
    <li><a href="http://sourceforge.net/projects/shark-project/develop">Subversion Repository</a></li>
  </ul>
  
</li>
<li class="first"><a href="../GettingStarted.html">Getting Started</a>
<li class="first"><a href="../Tutorials.html">Tutorials</a>
<li class="first"><a href="../FAQ.html">FAQ</a>

<li class="first"><a href="#">Main Modules</a>
<ul>
  <li class="first"><a href="../ReClaM/index.html">ReClaM</a>
  <li class="first"><a href="../EALib/index.html">EALib</a>
  <li class="first"><a href="../MOO-EALib/index.html">MOO-EALib</a>
  <li class="first"><a href="../Fuzzy/index.html">Fuzzy</a>
</ul>
</li>
<li class="first"><a href="#">Tools</a>
<ul>
  <li class="first"><a href="../Mixture/index.html">Mixture</a>
  <li><a href="../Array/index.html">Array</a>
  <li><a href="../Rng/index.html">Rng</a>
  <li><a href="../LinAlg/index.html">LinAlg</a>
  <li class="last"><a href="../FileUtil/index.html">FileUtil</a>		    
</ul>
</li>
</ul>
</div>

<!--<div id="header">
<div id="site-name">Shark Machine Learning Library</div>
  <ul id="nav">
    <li><a href="../index.html"><span>Shark&nbsp;Main&nbsp;Page</span></a></li>
    <li><a href="../Array/index.html"><span>Array</span></a></li>
    <li><a href="../Rng/index.html"><span>Rng</span></a></li>
    <li><a href="../LinAlg/index.html"><span>LinAlg</span></a></li>
    <li><a href="../FileUtil/index.html"><span>FileUtil</span></a></li>
    <li><a href="../EALib/index.html"><span>EALib</span></a></li>
    <li><a href="../MOO-EALib/index.html"><span>MOO-EALib</span></a></li>
    <li class="active"><a href="../ReClaM/index.html"><span>ReClaM</span></a></li>
    <li><a href="../Fuzzy/index.html"><span>Fuzzy</span></a></li>
    <li><a href="../Mixture/index.html"><span>Mixture</span></a></li>
    <li><a href="../tutorials/index.html"><span>Tutorials</span></a></li>
    <li><a href="../faq/index.html"><span>FAQ</span></a></li>
  </ul>
 </div> -->
<!-- Generated by Doxygen 1.7.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>KernelOptimization.cpp</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><span class="comment">//===========================================================================</span>
<span class="comment"></span><span class="preprocessor">#include &lt;Rng/GlobalRng.h&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="_dataset_8h.html" title="Functions for loading ReClaM datasets.">ReClaM/Dataset.h</a>&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="_artificial_distributions_8h.html" title="Artificial benchmark data.">ReClaM/ArtificialDistributions.h</a>&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="_svm_8h.html" title="Support Vector Machine interface.">ReClaM/Svm.h</a>&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="_k_t_a_8h.html" title="Implementation of the (negative) Kernel Target Alignment (KTA) as proposed by Nello Cristianini...">ReClaM/KTA.h</a>&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="_radius_margin_8h.html" title="Squared radius margin quotient.">ReClaM/RadiusMargin.h</a>&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="_l_o_o_8h.html" title="Leave One Out (LOO) Error for Support Vector Machines.">ReClaM/LOO.h</a>&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="_rprop_8h.html" title="This file offers classes to use the Resilient-Backpropagation-algorithm for the optimization of the a...">ReClaM/Rprop.h</a>&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="_c_m_a_optimizer_8h.html" title="The CMA-ES as a ReClaM Optimizer.">ReClaM/CMAOptimizer.h</a>&gt;</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;iostream&gt;</span>


<span class="keyword">using namespace </span>std;


<span class="keywordtype">int</span> main()
{
    <span class="comment">// create the chess board example</span>
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> examples = 100;
    <span class="keywordtype">double</span> C = 1000.0;
    <span class="keywordtype">double</span> gamma = 1.0;

    <a name="_a0"></a><a class="code" href="class_chessboard.html" title="Distribution of the chessboard classification problem.">Chessboard</a> chess;
    <a name="_a1"></a><a class="code" href="class_dataset.html" title="The Dataset class encapsulates a realization of data from a DataSource.">Dataset</a> ds;
    ds.<a name="a2"></a><a class="code" href="class_dataset.html#a05b4de6614286d4aa38cf2093c594d67" title="Create a Dataset from a generic DataSource.">CreateFromSource</a>(chess, examples, 0);
    <span class="keyword">const</span> Array&lt;double&gt;&amp; x = ds.<a name="a3"></a><a class="code" href="class_dataset.html#aecc03993b3c5df769fc2448215a66d71" title="access to the training data as a constant array">getTrainingData</a>();
    <span class="keyword">const</span> Array&lt;double&gt;&amp; y = ds.<a name="a4"></a><a class="code" href="class_dataset.html#ab601ec47a64794ee3f161db1fc880129" title="access to the training targets as a constant array">getTrainingTarget</a>();

    <span class="comment">// create svm models based on kernel models</span>
    <a name="_a5"></a><a class="code" href="class_r_b_f_kernel.html" title="Definition of the RBF Gaussian kernel.">RBFKernel</a>* k[3];
    k[0] = <span class="keyword">new</span> <a class="code" href="class_r_b_f_kernel.html" title="Definition of the RBF Gaussian kernel.">RBFKernel</a>(gamma);
    k[1] = <span class="keyword">new</span> <a class="code" href="class_r_b_f_kernel.html" title="Definition of the RBF Gaussian kernel.">RBFKernel</a>(gamma);
    k[2] = <span class="keyword">new</span> <a class="code" href="class_r_b_f_kernel.html" title="Definition of the RBF Gaussian kernel.">RBFKernel</a>(gamma);
    <a name="_a6"></a><a class="code" href="class_model.html" title="Base class of all models.">Model</a>* model[3];
    <a name="_a7"></a><a class="code" href="class_s_v_m.html" title="Support Vector Machine (SVM) as a ReClaM Model.">SVM</a> svm0(k[0], x);
    model[0] = <span class="keyword">new</span> <a name="_a8"></a><a class="code" href="class_c___s_v_m.html" title="Meta Model for SVM training.">C_SVM</a>(&amp;svm0, C, C);
    model[1] = k[1];
    <a class="code" href="class_s_v_m.html" title="Support Vector Machine (SVM) as a ReClaM Model.">SVM</a> svm2(k[2], x);
    model[2] = <span class="keyword">new</span> <a class="code" href="class_c___s_v_m.html" title="Meta Model for SVM training.">C_SVM</a>(&amp;svm2, C, C);

    <span class="comment">// create error functions</span>
    <a name="_a9"></a><a class="code" href="class_error_function.html" title="Base class of all error measures.">ErrorFunction</a>* err[3];
    err[0] = <span class="keyword">new</span> <a name="_a10"></a><a class="code" href="class_radius_margin.html" title="Squared Radius-Margin-Quotient.">RadiusMargin</a>();
    err[1] = <span class="keyword">new</span> <a name="_a11"></a><a class="code" href="class_negative_k_t_a.html" title="Implementation of the negative Kernel Target Alignment (KTA) as proposed by Nello Cristianini...">NegativeKTA</a>();
    err[2] = <span class="keyword">new</span> <a name="_a12"></a><a class="code" href="class_l_o_o.html" title="Leave One Out (LOO) Error for Support Vector Machines.">LOO</a>();

    <span class="comment">// create optimizer</span>
    <a name="_a13"></a><a class="code" href="class_optimizer.html" title="Base class of all optimizers.">Optimizer</a>* optimizer[3];
    optimizer[0] = <span class="keyword">new</span> <a name="_a14"></a><a class="code" href="class_i_rprop_plus.html" title="This class offers methods for the usage of the improved Resilient-Backpropagation-algorithm with weig...">IRpropPlus</a>();
    optimizer[1] = <span class="keyword">new</span> <a class="code" href="class_i_rprop_plus.html" title="This class offers methods for the usage of the improved Resilient-Backpropagation-algorithm with weig...">IRpropPlus</a>();
    optimizer[2] = <span class="keyword">new</span> <a name="_a15"></a><a class="code" href="class_c_m_a_optimizer.html" title="The CMA-ES as a ReClaM Optimizer.">CMAOptimizer</a>();

    <span class="comment">// define names</span>
    <span class="keywordtype">char</span> name[3][30] =
        {<span class="stringliteral">&quot;Radius Margin Quotient&quot;</span>,
         <span class="stringliteral">&quot;Kernel Target Alignment&quot;</span>,
         <span class="stringliteral">&quot;Leave One Out Error&quot;</span>,
        };

    <span class="comment">// do independent optimization runs</span>
    <span class="keywordtype">int</span> j, <a name="a16"></a><a class="code" href="_b_f_g_s_8cpp.html#ac23062089f3a5a2693cbb4ce7a75f1e5" title="Initializes some internal variables used by the BFGS algorithm, calculates the current error of the m...">i</a>;
    <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)
    {
        cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Optimization run &quot;</span> &lt;&lt; (j + 1) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; endl;
        cout &lt;&lt; <span class="stringliteral">&quot;Kernel optimization using the &quot;</span> &lt;&lt; name[j] &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; endl;
        cout &lt;&lt; <span class="stringliteral">&quot;initial kernel parameter: gamma = &quot;</span> &lt;&lt; k[j]-&gt;<a name="a17"></a><a class="code" href="class_model.html#a8e8eca8ae3e8e53ca0aa6a1731e1f0f6" title="Returns a specific model parameter.">getParameter</a>(0) &lt;&lt; endl;
        cout &lt;&lt; <span class="stringliteral">&quot;  Initializing the optimizer ...&quot;</span> &lt;&lt; flush;
        optimizer[j]-&gt;<a name="a18"></a><a class="code" href="class_optimizer.html#ad73a3c6a773c3ea280c59ecaee228830" title="basic initialization with default parameters">init</a>(*model[j]);
        cout &lt;&lt; <span class="stringliteral">&quot; done.&quot;</span> &lt;&lt; endl;

        <span class="keywordflow">for</span> (i = 0; i &lt; 40; i++)
        {
            cout &lt;&lt; <span class="stringliteral">&quot;  optimization iteration &quot;</span> &lt;&lt; (i + 1) &lt;&lt; flush;
            <span class="keywordtype">double</span> f = optimizer[j]-&gt;<a name="a19"></a><a class="code" href="class_optimizer.html#a6a8170818afe45a5516c4a4fea053f0f" title="Performes one optimization step, for example a gradient descent step or an evolution cycle...">optimize</a>(*model[j], *err[j], x, y);
            cout &lt;&lt; <span class="stringliteral">&quot;   f = &quot;</span> &lt;&lt; f &lt;&lt; endl;
        }
        cout &lt;&lt; <span class="stringliteral">&quot;final kernel parameter: gamma = &quot;</span> &lt;&lt; k[j]-&gt;<a class="code" href="class_model.html#a8e8eca8ae3e8e53ca0aa6a1731e1f0f6" title="Returns a specific model parameter.">getParameter</a>(0) &lt;&lt; endl;
    }


    <span class="comment">// next three lines are need for self-testing, please ignore</span>
    <span class="keywordtype">double</span> err0 = err[0]-&gt;<a name="a20"></a><a class="code" href="class_error_function.html#a116fe3002d98786b63ccc5f1a480ac14" title="Error of the model.">error</a>(*model[0], x, y);
    <span class="keywordtype">double</span> err1 = err[1]-&gt;<a class="code" href="class_error_function.html#a116fe3002d98786b63ccc5f1a480ac14" title="Error of the model.">error</a>(*model[1], x, y);
    <span class="keywordtype">double</span> err2 = err[2]-&gt;<a class="code" href="class_error_function.html#a116fe3002d98786b63ccc5f1a480ac14" title="Error of the model.">error</a>(*model[2], x, y);
    <span class="comment">// end self-testing block</span>

    <span class="comment">// clean up</span>
    <span class="keyword">delete</span> k[0];
    <span class="keyword">delete</span> k[1];
    <span class="keyword">delete</span> k[2];
    <span class="keyword">delete</span> err[0];
    <span class="keyword">delete</span> err[1];
    <span class="keyword">delete</span> err[2];
    <span class="keyword">delete</span> model[0];
    <span class="keyword">delete</span> model[2];
    <span class="keyword">delete</span> optimizer[0];
    <span class="keyword">delete</span> optimizer[1];
    <span class="keyword">delete</span> optimizer[2];

    <span class="comment">// lines below are for self-testing this example, please ignore</span>
    <span class="keywordflow">if</span> (err0&lt;=100 &amp;&amp; err1&lt;=-0.143 &amp;&amp; err2&lt;=0.09) exit(EXIT_SUCCESS);
    <span class="keywordflow">else</span> exit(EXIT_FAILURE);
}
</pre></div> </div>
</div>
</div>
</div>
</body></html>
